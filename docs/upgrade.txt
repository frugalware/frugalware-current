= Upgrading from Frugalware 0.6 to 0.7

== Preamble

The aim of this howto is to show how you can upgrade a Frugalware-0.6
(Terminus) system to Frugalware-0.7 (Sayshell).

== libpacman

Sayshell comes with a new package magement library, called libpacman. It is
provided by the `pacman-g2` package, so the first step is to install it:

-------------------------------------------------------------------------------
# pacman-g2 -Sy pacman-g2
-------------------------------------------------------------------------------

NOTE: Don't worry, this will upgrade glibc and the timezone database, too. This
is expected.

== The first reboot

You have now a newer glibc installed which is not binary compatible with the
previous one. You need to reboot to continue the upgrade.

IMPORTANT: If you don't reboot now, you will get strange warnings - don't skip
this step!

== Removing obsolete packages

Some software has been removed from Sayshell, after the upgrade you can install
their alternates. To remove them:

----
# pacman-g2 -Rd gst-plugins-bad-swfdec gst-plugins-bad-wavpack libgc
----

NOTE: Of course if you don't have these packages (which is not the default) you
can skip this step.

== Upgrading the system

Now it's time to upgrade the system itself:

-------------------------------------------------------------------------------
# pacman-g2 -Su
-------------------------------------------------------------------------------

You will be asked to replace a few packages automatically. The following ones
are normal and you are expected to answer 'Y' to these questions (or just hit
ENTER):

----
: Starting local database upgrade...
:: Replace cvsup with frugalware/csup? [Y/n]
:: Replace frugalpkg with frugalware/gfpm? [Y/n]
:: Replace control-center with frugalware/gnome-control-center? [Y/n]
:: Replace libgksu2 with frugalware/libgksu? [Y/n]
:: Replace gaim with frugalware/pidgin? [Y/n]
:: Replace gaim-plugin-encryption with frugalware/pidgin-encryption? [Y/n]
:: Replace gaim-plugin-guifications with frugalware/pidgin-plugin-guifications? [Y/n]
:: Replace scrollkeeper with frugalware/rarian? [Y/n]
:: Replace util-linux with frugalware/util-linux-ng? [Y/n]
:: Replace x-cursors-industrial with frugalware/x-cursors-dmz? [Y/n]
----

After this the list of to-be-upgraded packages is displayed. Just hit enter and
wait. Make some tea, it can take a while :-)

== Install replacement softwares

----
# pacman-g2 -S gst-plugins-bad gst-plugins-good-wavpack libgc --noconfirm
----

NOTE: If you did not remove the equivalent of these packages before the
upgrade, then you can skip this step.

== amavis and munin

The upgrade of these packages are not fully automated. You have to read the
documents located at `/usr/share/doc/amavisd-new-2.5.2/README.Frugalware` and
`/usr/share/doc/munin-1.2.5/README.Frugalware` to complete the upgrade if you
have these packages installed.

== Device name changes

Intel users will have `/dev/sd*` devices rather than `/dev/hd*` ones. The
reason is the following: It was not possible to boot the kernel on some
machines without this change. See link:http://bugs.frugalware.org/2243[this
bugreport] for more details. So after upgrading, you need to:

* Check if you have an Intel IDE controller using `lspci |grep -i intel.*ide`
  as `root`. If you got no result then probably you're not affected.

* Edit `/etc/fstab`: change all occurrences of `/dev/hd` to `/dev/sd`.

* Edit `/boot/grub/menu.lst`: change all occurrences of `/dev/hd` to `/dev/sd`
  in the Frugalware entry.

== The second reboot

Since the kernel is upgraded, too, you have to reboot your machine again.

Done!
