# Last Modified: Fri, 16 Sep 2005 21:23:02 +0200
# Compiling Time: 0.03 SBU
# Maintainer: Tuxbubling <tuxbubling@tiscali.fr>

pkgname=john
pkgver=1.6.39
pkgrel=1
pkgdesc="John the Ripper is a fast password cracker."
url="http://www.openwall.com/john/"
depends=()
groups=('apps-extra')
archs=('i686' 'x86_64')
up2date="lynx -dump http://www.openwall.com/john/ | grep 'sources only' | sort -r | tail -n 1| sed 's/.*Ripper //' | cut -f 1 -d ' '"
source=(http://www.openwall.com/john/c/$pkgname-$pkgver.tar.gz \
	john john-mailer http://frugalware.org/~krix/$pkgname-chrs.tar.bz2)
sha1sums=('abd9a9f8269b7288f6e834b402fa4d0c8f5191de' \
	  '215f1d0f271c10bccff2ef652ad8f07cb6e32196' \
	  'ba20178891ed1ca2aac942af00cf0ce5d6738921' \
	  'ab6461b07c8b9c8669154d4e58f52044c1396208')

[ "$CARCH" == "x86_64" ] && targetarch=linux-x86-64
[ "$CARCH" != "x86_64" ] && targetarch=linux-x86-mmx-elf

build()
{
	# Create needed dirs
	Fmkdir usr/lib/
	Fmkdir usr/share/doc/$pkgname-$pkgver

	# Add CFLAGS and run make
	Fcd $pkgname-$pkgver/src
	Fsed "CFLAGS =" "CFLAGS = $CFLAGS" ./Makefile
	Fsed "-m486" "" ./Makefile
	make $targetarch || return 1

	# Move and install files
	mv ../run $Fdestdir/usr/lib/john
	mv ../doc $Fdestdir/usr/share/doc/$pkgname-$pkgver
	Fexe usr/bin/john
	Fexe usr/bin/john-mailer
	Fln /usr/lib/john/john usr/bin/unafs
	Fln /usr/lib/john/john usr/bin/unique
	Fln /usr/lib/john/john usr/bin/unshadow
	Frm usr/lib/john/un{afs,ique,shadow}
	Ffilerel $Fsrcdir/john-chrs/* /usr/lib/john/
}

# optimalization ok
# vim: ft=sh
