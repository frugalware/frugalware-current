# Last Modified: Sat, 11 Mar 2006 11:25:15 +0100
# Compiling Time: 0.03 SBU
# Maintainer: DNAku <DNAku@frugalware.org>
# Old Maintainer: Tuxbubling <tuxbubling@tiscali.fr>

pkgname=john
pkgver=1.7.0.1
pkgrel=1
pkgdesc="John the Ripper is a fast password cracker."
url="http://www.openwall.com/john/"
depends=()
groups=('apps-extra')
archs=('i686' 'x86_64')
up2date="lynx -dump http://openwall.com/john |grep -m1 'John the Ripper [0-9]'|sed 's/.*per.//g'|sed 's/ .*//g'"
source=(http://openwall.com/john/e/john-$pkgver.tar.gz \
	john john-mailer http://frugalware.org/~krix/$pkgname-chrs.tar.bz2)
sha1sums=('903b0e47772087225285e8b2f9937034437ad7b6' \
	  '215f1d0f271c10bccff2ef652ad8f07cb6e32196' \
	  'ba20178891ed1ca2aac942af00cf0ce5d6738921' \
	  'ab6461b07c8b9c8669154d4e58f52044c1396208')

[ "$CARCH" == "x86_64" ] && targetarch=linux-x86-64
[ "$CARCH" == "i686" ] && targetarch=linux-x86-mmx

build()
{
	# Create needed dirs
	Fmkdir usr/lib/
	Fmkdir usr/share/doc/$pkgname-$pkgver

	# Add CFLAGS and run make
	Fcd $pkgname-$pkgver/src
	Fsed "CFLAGS =" "CFLAGS = $CFLAGS" ./Makefile
	Fsed "-m486" "" ./Makefile
	make $targetarch || return 1

	# Move and install files
	mv ../run $Fdestdir/usr/lib/john
	mv ../doc $Fdestdir/usr/share/doc/$pkgname-$pkgver
	Fexe usr/bin/john
	Fexe usr/bin/john-mailer
	Fln /usr/lib/john/john usr/bin/unafs
	Fln /usr/lib/john/john usr/bin/unique
	Fln /usr/lib/john/john usr/bin/unshadow
	Frm usr/lib/john/un{afs,ique,shadow}
	Ffilerel $Fsrcdir/john-chrs/* /usr/lib/john/
}

# optimalization OK
