# Last Modified: Tue, 06 Sep 2005 18:16:16 +0200
# Compiling Time: 9 sec
# Maintainer: Zoltan Kiss <djsmiley@inflame.hu>

pkgname=munin
pkgver=1.2.3
pkgrel=1
pkgdesc="Munin is a tool for graphing all sorts of information about one or more servers and displaying it in a web interface."
url="http://munin.projects.linpro.no/"
depends=('rrdtool>=1.2.11-2' 'perl-html-template')
groups=('network-extra')
archs=('i686')
up2date="lynx -dump $url|grep 'Stable'|sed 's/.*: \(.*\)\ .*D.*/\1/'"
source=(http://puzzle.dl.sourceforge.net/sourceforge/munin/munin_$pkgver.tar.gz  Makefile.config munin.cron munin.logrotate rrdtool12.patch)
sha1sums=('ed9a556a7540fb93c5c8d504c595af631e9ec80f' \
	  '2a673dd3cc2765a430d42d3d99acec8dd52beb6f' \
	  '876dfcb7c1690be14611db4e9d55b9b40cedac88' \
	  'a1ce31369c2278c1f53509178856341f9a9f6cc6' \
	  'bedd8559834956b87190dcb9718d9d6463db88b9')
					
build()
{
	Fpatchall
	cp -f $Fsrcdir/Makefile.config ./
	make install-main DESTDIR=$Fdestdir
	Ffile var/spool/cron/crontabs/munin.cron
	Fmv var/spool/cron/crontabs/munin.cron var/spool/cron/crontabs/munin
	Ffile etc/logrotate.d/munin.logrotate
	Fmv etc/logrotate.d/munin.logrotate etc/logrotate.d/munin

	Fsed "$Fdestdir" "" $Fdestdir/etc/munin/munin.conf
	Fsed "$Fdestdir"/"" "" $Fdestdir/usr/bin/munin-cron
	Fsed "$Fdestdir" "" $Fdestdir/usr/lib/perl5/site_perl/`perl -e 'printf "%vd", $^V'`/Munin.pm
	Fsed "$Fdestdir" "" $Fdestdir/usr/share/munin/munin-graph
	Fsed "$Fdestdir" "" $Fdestdir/usr/share/munin/munin-html
	Fsed "$Fdestdir" "" $Fdestdir/usr/share/munin/munin-limits
	Fsed "$Fdestdir" "" $Fdestdir/usr/share/munin/munin-update
	Fsed "$Fdestdir" "" $Fdestdir/usr/libexec/cgi-bin/munin-cgi-graph
}

# optimalization OK

# vim: ft=sh
