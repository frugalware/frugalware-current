# Compiling Time: 0.01 SBU
# Maintainer: DeX77 <dex77@frugalware.org>

pkgname=micro
pkgver=1.4.1
pkgextraver=dd5afc0
pkgrel=1
pkgdesc="A modern and intuitive terminal-based text editor"
groups=('apps-extra')
license=('MIT')
archs=('x86_64')
depends=('glibc')
makedepends+=('go' 'git')
_F_github_author="zyedidia"
_F_github_tag_v="y"
_F_github_grepv="nightly\|rc1"
Finclude github
source=("https://github.com/zyedidia/micro/releases/download/v${pkgver}/micro-$pkgver-src.tar.gz")
sha1sums=('edb7a5f0eef0ff11d47f620a739b4f9c8095672d')
_F_cd_path="src/github.com/zyedidia/micro"

build() {
	Fexec rm -rf src/github.com/zyedidia/
        Fexec mkdir -p src/github.com/zyedidia/
        Fexec mv "${pkgname}" src/github.com/zyedidia/micro

        Fcd

        export GOPATH="$Fsrcdir"
        export PATH=$PATH:$GOROOT/bin


	Fsed 'VERSION = $(shell go run tools/build-version.go)' "VERSION = $pkgver" Makefile
	Fsed 'HASH = $(shell git rev-parse --short HEAD)' "HASH = $pkgextraver" Makefile

	Fexec make build-quick || Fdie

	Fexerel micro usr/bin/micro
}


# optimization OK
