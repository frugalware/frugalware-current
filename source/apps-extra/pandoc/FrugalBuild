# Compiling Time: 0.03 SBU
# Maintainer: DeX77 <dex77@frugalware.org>

pkgname=pandoc
pkgver=3.0.1
pkgrel=1
pkgdesc='Conversion between markup formats'
url='https://pandoc.org'
groups=('apps-extra')
archs=('x86_64')
depends=('haskell-juicypixels' 'haskell-aeson-pretty' \
	'haskell-commonmark-pandoc' 'haskell-data-default' \
	'haskell-hslua-module-text' 'haskell-hslua-module-system' \
	'haskell-blaze-html' 'haskell-network' 'haskell-xml' \
	'haskell-safe' 'haskell-case-insensitive' 'haskell-glob' \
	'haskell-sha' 'haskell-doclayout' 'haskell-file-embed' \
	'haskell-haddock-library' 'haskell-hslua-module-path' \
	'haskell-http-types' 'haskell-split' 'haskell-base64' \
	'haskell-tls' 'haskell-connection' 'haskell-doctemplates' \
	'haskell-gridtables' 'haskell-citeproc' 'haskell-gridtables' \
	'haskell-hslua-module-doclayout' 'haskell-hslua-module-version' \
	'haskell-http-client' 'haskell-http-client-tls' \
	'haskell-ipynb' 'haskell-jira-wiki-markup' 'haskell-lpeg' \
	'haskell-pandoc-lua-marshal' 'haskell-pretty-show' \
	'haskell-servant-server' 'haskell-skylighting' 'haskell-skylighting-core' \
	'haskell-tagsoup' 'haskell-texmath' 'haskell-unicode-collation' \
	'haskell-wai' 'haskell-wai-extra' 'haskell-warp' 'haskell-xml-conduit' \
	'haskell-xml-types' 'haskell-yaml' 'haskell-zip-archive')
_F_haskell_setup="Setup.hs"
_F_haskell_confopts="	-O \
			--enable-shared \
			--enable-executable-dynamic \
			--disable-library-vanilla \
			--prefix=/usr \
			--docdir=/usr/share/doc/${pkgname} \
			--dynlibdir=/usr/lib \
			--libsubdir=\$compiler/site-local/\$pkgid \
			-f embed_data_files"
Finclude haskell
source=(https://github.com/jgm/pandoc/archive/refs/tags/${pkgver}.tar.gz \
	build.patch)
sha1sums=('0d3fefbb47c2841bf9d4e8f6298c469633e27c53' \
          'db7388950c162c48aa7fe1763ab9352088d3b20c')

build() {
  Fcd
  Fpatchall
  Fexec runhaskell $_F_haskell_setup configure $_F_haskell_confopts || Fdie
  Fexec runhaskell $_F_haskell_setup build || Fdie
  Fbuild_haskell_regscripts
  Fexec runhaskell $_F_haskell_setup copy --destdir=$Fdestdir
}

# optimization OK
