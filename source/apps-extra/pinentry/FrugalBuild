# Compiling Time: ~0.1 SBU
# Maintainer: voroskoi <voroskoi@frugalware.org>

pkgname=pinentry
pkgver=0.7.6
pkgrel=1
pkgdesc="Applications for entering PINs or Passphrases."
url="http://ftp.gnupg.org/gcrypt/pinentry/"
depends=('libcap' 'ncurses')
groups=('apps-extra')
archs=('i686' 'x86_64')
Finclude texinfo
up2date="lynx -dump ftp://ftp.gnupg.org/gcrypt/pinentry/ |grep pinentry.*tar |sed -e 's/.*y-\(.*\)\.t.*/\1/;s/-/_/' |sort -r |sed -n -e '1 p'"
source=(ftp://ftp.gnupg.org/gcrypt/pinentry/$pkgname-$pkgver.tar.gz)
options=('scriptlet')
signatures=($source.sig)

subpkgs=("${subpkgs[@]}" "$pkgname-gtk+")
subdescs=("${subdescs[@]}" "GTK+ based Applications for entering PINs or Passphrases.")
subdepends=("${subdepends[@]}" "gtk+")
subrodepends=("${subrodepends[@]}" "$pkgname>=$pkgver")
subgroups=("${subgroups[@]}" 'xapps-extra')
subarchs=("${subarchs[@]}" 'i686 x86_64')

subpkgs=("${subpkgs[@]}" "$pkgname-gtk+2")
subdescs=("${subdescs[@]}" "GTK+2 based Applications for entering PINs or Passphrases.")
subdepends=("${subdepends[@]}" "gtk+2")
subrodepends=("${subrodepends[@]}" "$pkgname>=$pkgver")
subgroups=("${subgroups[@]}" 'xapps-extra')
subarchs=("${subarchs[@]}" 'i686 x86_64')

subpkgs=("${subpkgs[@]}" "$pkgname-qt")
subdescs=("${subdescs[@]}" "Qt3 based Applications for entering PINs or Passphrases.")
subdepends=("${subdepends[@]}" "qt")
subrodepends=("${subrodepends[@]}" "$pkgname>=$pkgver")
subgroups=("${subgroups[@]}" 'xapps-extra')
subarchs=("${subarchs[@]}" 'i686 x86_64')

subpkgs=("${subpkgs[@]}" "$pkgname-qt4")
subdescs=("${subdescs[@]}" "Qt4 based Applications for entering PINs or Passphrases.")
subdepends=("${subdepends[@]}" "libqtgui>=4.6.1 libice libxrender libxext ncurses libcap libgcc libuuid")
subrodepends=("${subrodepends[@]}" "$pkgname>=$pkgver")
subgroups=("${subgroups[@]}" 'xapps-extra')
subarchs=("${subarchs[@]}" 'i686 x86_64')

build()
{
	Fcd
	## brr
	for i in qt4/*.moc
	do
		/usr/bin/moc ${i/.moc/.h} > ${i} || Fdie
	done

	Fbuild
	Fln pinentry-curses $Fprefix/bin/pinentry

	Fsplit pinentry-gtk+ usr/bin/pinentry-gtk
	Fsplit pinentry-gtk+2 usr/bin/pinentry-gtk-2
	Fsplit pinentry-qt usr/bin/pinentry-qt
	Fsplit pinentry-qt4 usr/bin/pinentry-qt4
}

# optimization OK
