# Compiling Time: 0.08 SBU
# Maintainer: VMiklos <vmiklos@frugalware.org>

pkgname=truecrypt
pkgver=4.3
pkgextraver=a
pkgrel=15
pkgdesc="A free open-source disk encryption software"
url="http://www.truecrypt.org/"
Finclude kernel-module
depends=(${depends[@]} 'device-mapper')
groups=('apps-extra')
archs=('i686' 'x86_64')
up2date="lynx -dump http://www.truecrypt.org/downloads.php|grep Stable|sed 's/.* - //;s/$pkgextraver//'"
source=(http://www.truecrypt.org/downloads/truecrypt-$pkgver$pkgextraver-source-code.tar.gz \
	truecrypt-4.3a-2.6.23.patch)
sha1sums=('30c91901171c3c8290d4d0de856774cdf7ee4ed6' \
          '80e175465c56155c4335cd1f2d88ce11dd864c5d')

build()
{
	unset MAKEFLAGS
	Fcd truecrypt-$pkgver$pkgextraver-source-code/Linux
	Fpatchall
	Fsed 'uname -r' "echo $_F_kernelmod_uname" build.sh
	Fsed '>/dev/null' '' build.sh
	./build.sh || return 1
	Ffilerel Kernel/truecrypt.ko $_F_kernelmod_dir/misc/truecrypt.ko
	Fexerel Cli/truecrypt /usr/bin/truecrypt
	Ffilerel Cli/Man/truecrypt.1 /usr/share/man/man1/truecrypt.1
	Fdocrel ../Readme.txt ../Release
	Fbuild_kernelmod_scriptlet
}
