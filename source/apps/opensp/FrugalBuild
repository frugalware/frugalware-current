# Last Modified: Sat, 29 Oct 2005 21:15:07 +0200
# Compiling Time: 0.70 SBU
# Maintainer: VMiklos <vmiklos@frugalware.org>

pkgname=opensp
pkgver=1.5.1
pkgrel=2
pkgdesc="The OpenJade Group's SGML and XML parsing tools"
url="http://openjade.sourceforge.net/"
depends=('glibc' 'sgml-common')
groups=('apps')
archs=('i686' 'x86_64')
install=$pkgname.install
up2date="lynx -dump $url|grep stable.*OpenSP|sed 's/.*]\(.*\)\.$/\1/'"
source=( http://download.sourceforge.net/openjade/OpenSP-$pkgver.tar.gz $pkgname-$pkgver-silent.diff $pkgname-$pkgver-gcc34.diff)
sha1sums=('93bd4f99972c9a50e07c68e3161ed3c25f9a3b22' \
          '33c0586cf758c091d857a5deb877ed23422554f6' \
          'fd3a7ea778003669e7c9ca55b5315a1aaf0145bd')

build() {
	cd $startdir/src/OpenSP-$pkgver
	patch -p1 < $startdir/src/$pkgname-$pkgver-silent.diff
	patch -p1 < $startdir/src/$pkgname-$pkgver-gcc34.diff
	./configure --prefix=/usr --disable-static --enable-http \
		--enable-default-catalog=/etc/sgml/catalog \
		--enable-default-search-path=/usr/share/sgml
		
	make pkgdatadir=/usr/share/sgml/OpenSP-$pkgver || return 1
	
	make pkgdatadir=/usr/share/sgml/OpenSP-$pkgver \
		DESTDIR=$startdir/pkg install
	ln -sf onsgmls /usr/bin/nsgmls
	ln -sf osgmlnorm /usr/bin/sgmlnorm
	ln -sf ospam /usr/bin/spam
	ln -sf ospcat /usr/bin/spcat
	ln -sf ospent /usr/bin/spent
	ln -sf osx /usr/bin/sx
	ln -sf osx /usr/bin/sgml2xml
	ln -sf libosp.so /usr/lib/libsp.so
	mkdir -p $startdir/pkg/etc/sgml/
}

# vim: ft=sh

# optimalization OK
