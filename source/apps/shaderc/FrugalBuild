# Compiling Time: 26.46 SBU
# Maintainer: DeX77 <dex77@frugalware.org>

pkgname=shaderc
pkgver=2023.3
pkgrel=1
pkgdesc='Collection of tools, libraries and tests for shader compilation'
archs=('x86_64')
groups=('apps')
depends=('glslang>=12.0.0' 'spirv-tools')
makedepends=('ruby-asciidoctor' 'spirv-headers')
_F_github_author=google
_F_github_tag_v=y
_F_cmake_confopts="	-DSHADERC_SKIP_TESTS=ON \
			-DSHADERC_SKIP_EXAMPLES=ON \
			-Dglslang_SOURCE_DIR=/usr/include/glslang"
Finclude github cmake
source+=(de-vendor.patch)
sha1sums=('f08f1399bbfde0c6f96a794414c6a14f814718f6' \
          '3103a57a593a68b3243f08c4f60d724022444e14')

build() {
	Fcd
	cat <<- EOF > glslc/src/build-version.inc
"${pkgver}\\n"
"$(pacman -Q spirv-tools|cut -d \  -f 2|sed 's/-.*//')\\n"
"$(pacman -Q glslang|cut -d \  -f 2|sed 's/-.*//')\\n"
EOF
	CMake_build
}


# optimization OK
