# Compiling time: 0.17 SBU
# Maintainer: crazy <crazy@frugalware.org>

pkgname=mozjs
pkgver=78.0.1
pkgextraver=gnome
pkgrel=1
pkgdesc="JavaScript interpreter and libraries"
url="https://developer.mozilla.org/en-US/docs/Mozilla/Projects/SpiderMonkey/Releases/38"
depends=('readline' 'zlib' 'libstdc++>=9.1.0-2' 'icu4c>=67.1')
makedepends=('cargo' 'clang' 'clang-libs' 'llvm')
groups=('base')
archs=("x86_64")
source=(http://ftp.gnome.org/pub/GNOME/teams/releng/tarballs-needing-help/mozjs/$pkgname-$pkgver$pkgextraver.tar.xz)
up2date="Flasttar http://ftp.gnome.org/pub/GNOME/teams/releng/tarballs-needing-help/mozjs/"
sha1sums=('ead045c787ec885cd6584037cc3b6adea9908365')
options+=('static' 'clang' 'nolto')

replaces=('mozjs52' 'spidermonkey')
provides=('mozjs52' 'spidermonkey')

Fconfopts="     --with-system-zlib \
		--with-intl-api \
		--enable-shared-js \
		--disable-optimize \
		--disable-tests \
		--prefix=/usr \
		--disable-jemalloc \
		--with-system-icu"
_F_conf_configure="../js/src/configure"

build() {
	Fcd
	Fexec mkdir -p build || Fdie
	Fexec cd build || Fdie
	Fbuild
	Frm usr/lib/*.ajs

}



# optimization OK
