# Last Modified: Sun Apr 11 22:49:21 CEST 2004
# Compiling Time: ~1 minute
# Maintainer: VMiklos <mamajom@axelero.hu>

pkgname=slocate
pkgver=2.7
pkgrel=1
pkgdesc="Security Enhanced version of the GNU Locate"
url="http://www.geekreview.org/slocate"
depends=('glibc' 'util-linux' 'frugalware')
backup=('etc/updatedb.conf')
install=$pkgname.install
up2date=`lynx -dump http://www.geekreview.org/slocate/ |sed -n '1 p'|tr -s ' '|sed 's/v//'|cut -d ' ' -f 4`
source=(ftp://ftp.geekreview.org/slocate/src/slocate-$pkgver.tar.gz \
        slocate updatedb.conf)
md5sums=('4872830642ea2ed5f9aff932720583c9' \
         '3ee7c2f49ef41c4d55c79dad29043376' '3e22926889fd930a5f237058768f4cc6')

build() {
  cd $startdir/src/$pkgname-$pkgver
  ./autogen.sh --prefix=/usr
  make || return 1

  # install (the Makefile does a bad job of it, so we do it ourselves)
  install -cD -m644 ../updatedb.conf $startdir/pkg/etc/updatedb.conf
  install -cD -m744 ../slocate $startdir/pkg/etc/cron.daily/slocate
  mkdir -p $startdir/pkg/usr/bin
  install -cD -m2755 --group=21 slocate $startdir/pkg/usr/bin/slocate
  (cd $startdir/pkg/usr/bin && ln -sf slocate locate)
  (cd $startdir/pkg/usr/bin && ln -sf slocate updatedb)
  install -cD -m644 doc/slocate.1.linux.gz $startdir/pkg/usr/man/man1/slocate.1.gz
  install -cD -m644 doc/updatedb.1.gz $startdir/pkg/usr/man/man1/updatedb.1.gz
  (cd $startdir/pkg/usr/man/man1 && ln -sf slocate.1.gz locate.1.gz)

  # slocate's gid will be 21
  mkdir -p $startdir/pkg/var/lib
  install -cd -m750 --group=21 $startdir/pkg/var/lib/slocate
}
