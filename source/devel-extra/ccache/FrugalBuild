# Compiling Time: 0.01 SBU
# Maintainer: crazy <crazy@frugalware.org>

pkgname=ccache
pkgver=4.8.2
pkgrel=1
pkgdesc="A fast compiler cache"
url="http://ccache.dev"
depends=('hiredis' 'zstd')
makedepends=('ruby-asciidoctor')
groups=('devel-extra' 'devel-core')
archs=('x86_64')
_F_archive_grepv="linux-x86_64"
up2date="Flastarchive ${url}/download.html .tar.xz"
source=(https://github.com/$pkgname/$pkgname/releases/download/v${pkgver}/$pkgname-$pkgver.tar.xz \
	gcc-bugfix.patch \
	README.Frugalware)
sha1sums=('2a19866544e4f3989bfd0ada3496e3ced22f6f42' \
          '1f363869f906ec31b8a2bdf34c2a4e41d7f1ecc8' \
          '533569cbe2b4cdfb27da9a58594f3eed670a269a')
Finclude cmake

build() {

	CMake_build
	Fmkdir /usr/lib/ccache/bin

	local i
	for i in {$CHOST-,}{cc,c++,gcc,g++} clang clang++
	do
    	    Fln /usr/bin/ccache /usr/lib/ccache/bin/$i
	done
	Fexec install -d -m 2775 -g 48 $Fdestdir/var/cache/ccache/ || Fdie
	Fdoc README.Frugalware
}

# optimization OK
