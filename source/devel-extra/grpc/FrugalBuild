# Compiling Time: 0 SBU
# Maintainer: DeX77 <dex77@frugalware.org>

pkgname=grpc
pkgver=1.25.0
pkgrel=1
_gtestver=1.8.1
_upbver=931bbecbd3230ae7f22efa5d203639facc47f719
pkgdesc="High performance, open source, general RPC framework that puts mobile and HTTP/2 first."
archs=('x86_64')
groups=('devel-extra')
url='https://grpc.io'
depends=('openssl' 'c-ares' 'protobuf>=3.10.0')
_F_github_tag_v=yes
_F_github_grepv=pre
Finclude github
source+=("https://github.com/google/googletest/archive/release-$_gtestver/googletest-$_gtestver.tar.gz"
        "https://github.com/protocolbuffers/upb/archive/$_upbver/upb-$_upbver.tar.gz")
sha1sums=('f44584031c3f4a1b4353766e4173e23c3b0bf1ce' \
          '152b849610d91a9dfa1401293f43230c2e0c33f8' \
          '33364195f0df137f7872e5805461216457956cbf')
_F_make_opts+="  prefix=/usr AROPTS='-r'"
options=('nolto')

build() {
	Fcd
	ln -sf "$Fsrcdir/googletest-release-$_gtestver/"{googlemock,googletest} \
		third_party/googletest
	
	rm -rf third_party/upb
	ln -s "$Fsrcdir/upb-$_upbver" third_party/upb

	Fbuild
}

	

# optimization OK
