# Compiling Time: 0.06 SBU
# Maintainer: DeX77 <dex77@frugalware.org>

pkgname=lwt
pkgver=5.6.1
pkgrel=1
pkgdesc='A library for cooperative threads in OCaml'
archs=('x86_64')
groups=('devel-extra')
depends=('domainslib' 'ocaml-luv' 'ocplib-endian' 'ppxlib' 'ocaml-react')
makedepends=('dune' 'ocaml-compiler-libs' 'cppo' 'ocaml-static')
_F_github_author="ocsigen"
_F_github_tag=y
Finclude github
source+=(domainslib.patch \
	bytes.patch)
sha1sums=('1b4951470a2deda1f7ff859baf3488a2b6330ec9' \
          '50e4601e7b89893ca5f917f5be994844e8d91cc4' \
          '488ec7292be34d26a94df3c268ff9a43eb5feae6')


build() {
	Fcd
	Fpatchall

	LWT_DISCOVER_ARGUMENTS='--use-libev true'
	Fexec dune build --release --verbose || Fdie
	DESTDIR="$Fdestdir" dune install --prefix '/usr' --libdir '/usr/lib/ocaml'
}

# optimization OK
