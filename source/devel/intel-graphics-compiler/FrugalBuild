# Compiling Time: 0.41 SBU
# Maintainer: DeX77 <dex77@frugalware.org>

pkgname=intel-graphics-compiler
pkgver=1.0.12812.13
pkgrel=1
pkgdesc="Intel Graphics Compiler for OpenCL"
archs=("x86_64")
depends=('intel-opencl-clang>=15.0.0' 'spirv-tools')
makedepends=('llvm' 'llvm-static' 'clang' 'git' 'openmp' \
	'mlir' 'polly' 'libunwind' 'lld' 'spirv-headers' \
	'spirv-llvm-translator' 'vc-intrinsics')
groups=('devel')
_F_github_author="intel"
_F_github_tag=y
_F_github_tag_prefix="igc-"
_F_cmake_confopts="	-DCMAKE_BUILD_TYPE=Release \
		        -DCMAKE_INSTALL_PREFIX=/usr \
		        -DCMAKE_INSTALL_LIBDIR=lib \
		        -DIGC_OPTION__ARCHITECTURE_TARGET='Linux64' \
			-DIGC_OPTION__LLVM_PREFERRED_VERSION='15.0.6' \
		        -DINSTALL_GENX_IR=ON \
			-DIGC_OPTION__CLANG_MODE=Prebuilds \
			-DIGC_OPTION__LLD_MODE=Prebuilds \
			-DIGC_OPTION__LLVM_MODE=Prebuilds \
			-DIGC_OPTION__VC_INTRINSICS_MODE=Prebuilds \
			-DIGC_OPTION__LINK_KHRONOS_SPIRV_TRANSLATOR=ON \
			-DIGC_OPTION__USE_KHRONOS_SPIRV_TRANSLATOR_IN_VC=ON \
			-DIGC_OPTION__SPIRV_TOOLS_MODE=Prebuilds \
			-DIGC_OPTION__USE_PREINSTALLED_SPRIV_HEADERS=ON \
			-DIGC_OPTION__SPIRV_TRANSLATOR_MODE=Prebuilds"
Finclude cmake github
up2date="$up2date | sed 's/igc-//g'"
source+=(int-conversion.patch \
	opaque-pointer.patch \
	vc-fix.patch)
sha1sums=('d5b0de81c1b52957f18c1c662eb4f6a720006d1e' \
          '43bbc27891537300e66f6803e4628414f82d6ea5' \
          'af37d095d2c35c7717cb502974aadf8468376d52' \
          '35ecdd46b703b13c4435c94a35fc114dad9f54d5')
_F_cd_path="intel-graphics-compiler-igc-$pkgver"
options=('nolto' )

# optimization OK
