# Compiling time: 3.45 SBU
# Maintainer: bouleetbil <bouleetbil@frogdev.info>

pkgname=mono
pkgver=2.8
pkgrel=2
pkgdesc="Mono runtime and class libraries, a C# compiler/interpreter"
url="http://www.mono-project.com/"
depends=('glib2' 'zlib')
makedepends=('libgdiplus>=2.8')
rodepends=('libxml2')
groups=('devel')
archs=('i686' 'x86_64' 'ppc')
Finclude mono
up2date="lynx -dump http://www.go-mono.com/sources-stable/|grep -m1 'mono-'|sed 's/.*-\(.*\).t.*/\1/'"
source=(http://www.go-mono.com/sources/$pkgname/$pkgname-$pkgver.tar.bz2 rc.mono rc.mono-hu.po)
Fconfopts="$Fconfopts --with-tls=__thread --with-libgdiplus=installed --with-moonlight=no \
	--with-preview=yes --with-gc=included --with-profile2=yes --with-profile4=yes"

#Don't enable --enable-big-arrays we should have >3Go of ram
#we can add --with-ikvm-native=yes for replace ikvm package and use native ikvm

sha1sums=('a724de68dccb583b54d2e08c5a1e5760c18225ab' \
          '1a6826fb1bb13f906a1465be43bb592a2a9e0e10' \
          '6c19f98462d7bb1ecba79a3ad284ea02a1eac2ec')

subpkgs=("monodoc")
subdescs=("Documentation for mono's .Net class library")
subdepends=('mono>=2.4')
subgroups=('devel-extra')
subarchs=('i686 x86_64 ppc')

build() {
	unset MAKEFLAGS
	Fcd
	Fpatchall
	Fmonoexport
	Fmake
	Fmakeinstall
	Fmonocleanup
	Fsplit monodoc /usr/lib/monodoc
	Fsplit monodoc /usr/lib/mono/monodoc
	Fsplit monodoc /usr/lib/mono/gac/monodoc
	Fsplit monodoc /usr/bin/mdvalidater
	Fsplit monodoc /usr/bin/mdoc*
	Fsplit monodoc /usr/bin/mdassembler
	Fsplit monodoc /usr/share/man/man5/mdoc.5
	Fsplit monodoc /usr/share/man/man1/monodocs2html.1
	Fsplit monodoc /usr/share/man/man1/mdvalidater.1
	Fsplit monodoc /usr/lib/pkgconfig/monodoc.pc
}

# optimization OK
