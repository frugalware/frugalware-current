# Compiling Time: 0.62 SBU
# Maintainer: Miklos Vajna <vmiklos@frugalware.org>

USE_DEVEL=${USE_DEVEL:-"n"}
USE_STABLE=${USE_STABLE:-"n"}

pkgname=pacman-tools
pkgver=1.3.4
Fuse $USE_DEVEL && pkgver=1.1.7.13.g544f9ab
pkgrel=15
pkgdesc="Tools for developers for managing packages"
url="http://ftp.frugalware.org/pub/other/pacman-tools"
depends=('bash' 'perl>=5.28.2' 'pacman-g2>=3.9.0-25' 'wget>=1.11.4-2'
	'python>=2.7' 'libxml2>=2.6.32-2' 'glib2>=2.16.4-2' 'openssl>=1.0.0'
	'shadow')
makedepends=('asciidoc' 'docbook-xsl' 'docbook-xml' 'sgml-common')
groups=('devel' 'devel-core')
archs=("x86_64")
backup=(etc/repoman.conf etc/syncpkg{cd/c,d/d,d/ctl}config.py)
up2date="Flasttar $url"
if ! Fuse $USE_DEVEL; then
	source=($url/$pkgname-$pkgver.tar.gz \
	0001-__pkg_commit_info.patch  \
	0002-info-added-some-missing-checks.patch \
	0001-chkdep.patch 0001-fblint.patch \
	0001-repoman.patch \
	chkworld-fix-for-newer-perl.patch)
	signatures=("${source[0]}.asc" '' '' '' '' '' '')
	if Fuse $USE_STABLE; then
		source=("${source[@]}" stable.patch)
		signatures=("${signatures[@]}" '')
	fi
else
	_F_scm_type="git"
	_F_scm_url="git://git.frugalware.org/pub/other/pacman-tools/pacman-tools"
	Finclude scm
fi
## won't compile with asneeded
options=('scriptlet' 'noasneeded' 'noclash')

build()
{
	Fbuild
	Fmkdir /etc/sudoers.d
	echo "syncpkgd ALL=(ALL) NOPASSWD: /usr/bin/makepkg" > pacman-tools
	Finstallrel 440 /etc/sudoers.d/pacman-tools
}

# optimization OK
