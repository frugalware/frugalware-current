# Compiling Time: 0.83 SBU
# Maintainer: Priyank <priyankmg@gmail.com>

pkgname=glest
pkgver=2.0.0
pkgrel=1
pkgdesc="Cross-platform 3D realtime strategy game"
_F_sourceforge_ext=".zip"
Finclude sourceforge
url="http://www.glest.org/"
makedepends=('jam' 'hd2u')
depends=('sdl' 'libogg' 'libvorbis' 'openal' 'xerces-c' 'libxt' 'libx11' 'mesa' 'glest-data')
groups=('games-extra')
archs=('i686')
up2date="lynx -dump http://sourceforge.net/project/showfiles.php?group_id=127297 | grep -m1 source | sed 's/.*ce.*]\(.*\) Ap.*/\1/'"
source=(${source/glest-/glest_source_} $pkgname-$pkgver-gcc41.patch glest)
sha1sums=('a9f05c243eca20e23a8c5324a06cb7323c7b98a7' \
	  '608e2473f705b69ba04c9c08ba6f1a0fc88d978a' \
	  '8a0b4eb824a4ecd48cda3b836f60570188bdd096')
Fprefix="/usr/share"

build() {
	for i in `find $Fsrcdir/glest_source_$pkgver/{source,mk} -type f`; do dos2unix $i; done
	Fcd ${pkgname}_source_${pkgver}
	patch -Np1 -i $Fsrcdir/$pkgname-$pkgver-gcc41.patch || return 1
	cd mk/linux
	chmod a+x *.sh || return 1
	Fmkdir usr/{share/glest,bin}
	if [[ ! -e configure ]] ; then
	./autogen.sh || die "autogen failed"
	fi

	# Lets build glest
	Fconf
	jam || return 1

	# Install glest
	Finstallrel 755 glest usr/share/glest/
	Ffilerel glest.ini usr/share/glest/
	Finstall 755 glest usr/bin/glest
}

# optimization OK
