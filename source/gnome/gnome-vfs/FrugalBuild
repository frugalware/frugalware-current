# Compiling time: 1.35 SBU
# Maintainer: Christian Hamar alias krix <krics@linuxforum.hu>
# Contributor: AlexExtreme <alex@alex-smith.me.uk>

pkgname=gnome-vfs
pkgver=2.18.1
pkgrel=4
pkgdesc="GNOME Virtual File System"
url="http://www.gnome.org/"
depends=('gconf>=2.18.0.1' 'bzip2' 'hal>=0.5.8.1' 'dbus-glib>=0.71' 'gnome-mime-data' 'gamin' \
	'avahi-glib>=0.6.17' 'xfsprogs-acl' 'heimdal>=1.0' 'db>=4.5.20')
makedepends=('intltool' 'gtk-doc' 'samba')
rodepends=('gnome-mount>=0.6')
groups=('gnome' 'gnome-core')
archs=('i686' 'x86_64')
_F_gnome_schemas=('/etc/gconf/schemas/desktop_default_applications.schemas'
	'/etc/gconf/schemas/desktop_gnome_url_handlers.schemas'
	'/etc/gconf/schemas/system_dns_sd.schemas'
	'/etc/gconf/schemas/system_http_proxy.schemas'
	'/etc/gconf/schemas/system_smb.schemas')
Finclude gnome gnome-scriptlet
source=(${source[@]} 00-default-browser.patch \
	02-user-visible-drives.patch \
	fstab_edit_crash.patch \
	resolve_fstab_symlinks.patch \
	gnome-vfs-2.8.2-schema_about_for_upstream.patch \
	gnome-vfs-2.9.90-modules-conf.patch)
sha1sums=('e939fe4fe2e75516ae6c4d476f8fb44f59ec8bdc'\
          'c83d61988a083c3906b0ce806bb41beb7b628af2'\
          '6570dfb9cb50c8f4ca03a7bcf6c4cf8b0e523214'\
          'e94438c68532a1c36a7b5f0c305ab065695d626a'\
          '0e28ca35f7f2bc156b7f25d0cfcd331847a6b8d3'\
          '432a5cfa68e440fd6de0bfccf838270abdd2fbdf'\
          'b7ab40b31d384d4d602a9dfa2808c810dccdbdbb')

build() {
	# The pmount options are still there because gnome-vfs can fallback to pmount if gnome-mount is unavailable
	Fpatchall
	Fautoconfize
	Fmake --disable-schemas-install --enable-gtk-doc --disable-cdda \
		--with-hal-mount=/usr/bin/pmount-hal \
		--with-hal-umount=/usr/bin/pumount \
		--enable-hal --enable-avahi --enable-ipv6
	Fmakeinstall GCONF_DISABLE_SCHEMA_INSTALL=1
	Fbuild_gnome_scriptlet
}

# optimization OK
