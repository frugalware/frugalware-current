# Compiling time: 18.40 SBU
# Maintainer: crazy <crazy@frugalware.org>
# Contributor: Kapolnasi Tamas <ktamas@tdc.hu>


pkgname=kdelibs
pkgver=3.5.5
pkgrel=1
pkgdesc="KDE Core Libraries."
depends=('arts>=1.5.5' 'hicolor-icon-theme' 'libxslt' 'pcre' 'lesstif' 'openssl' 'libart_lgpl' 'gamin'  'bzip2' \
         'xfsprogs-acl' 'openexr>=1.4.0a' 'libidn' 'aspell'  'jasper' 'avahi-qt3>=0.6.14-2' 'avahi-compat>=0.6.14-2' 'db')
makedepends=('cups>=1.2.3' 'openldap' 'heimdal' 'sane-backends' 'hspell' 'flex' 'opensp' 'openjade' 'doxygen' 'qt-docs>=3.3.6-1')
rodepends=('dejavu-ttf' 'corefonts' 'aspell6-en')
groups=('kde' 'kde-core')
archs=('i686' 'x86_64')
options=('scriptlet')
Finclude kde
source=(${source[@]} kde.sh \
        x-mplayer2.desktop \
	fw-default-dejavu-font.patch \
	experimental.patch inotify.patch  \
	kdeprintrc.patch admin_fix.patch)
## NOTE: if someone change fw-default-dejavu-font.patch its _NEED_ be in sync with
## fw-default-dejavu-font.patch from kdebase and both pkgs _NEED_ be recompiled!
sha1sums=('7961818e41e22cce7c58219c4eb63ed5fbb94307' \
          'b67afb54be3b2ac24ba9a491cb38a871a27a6316' \
          'e45f5f357859f243e627cfaa7bd9682ac49c2eab' \
          '9fa69d12efc57f8c9644379e040101d47a3bf9fe' \
          '38cc8d671e41392a286bf6b597d7c0e187f4019b' \
          '28bc994050782f5e84839e70dcacf7422d990818' \
          '92a69598fca05c346e954ad55bb9ea9defa93b1e' \
          'bc06a34c923ad1bf546cee72ad60c71bf23491f0')


subpkgs=('kde-apidox')
subdescs=('KDE API Documentation')
subdepends=("$pkgname>=$pkgver doxygen qt-docs>=3.3.6-1")
subgroups=('kde-extra kde-docs')
subarchs=('i686 x86_64')

build()
{
	Fcd
	Fpatchall
    	make -f admin/Makefile.common cvs || return 1
    	Fmake	--with-distribution="Frugalware Linux" \
	   	--disable-{debug,warnings} \
           	--enable-{sendfile,ltdl-install,mitshm} \
		--disable-dnotify --enable-inotify \
           	--with-{alsa,aspell,hspell,libart,acl}  \
           	--enable-gcc-hidden-visibility --without-debug \
           	CXXFLAGS="$CXXFLAGS -Wno-deprecated" \
		--without-lua-dir --without-lua-includes \
		--without-lua-libraries \
		--enable-final
	make apidox || return 1
	Fmakeinstall
	Fsplit kde-apidox usr/share/doc/HTML/en/kdelibs-apidocs
	Fexe /etc/profile.d/kde.sh
	Frm /usr/share/icons/hicolor/index.theme
	Ffile /usr/share/mimelnk/application/x-mplayer2.desktop
}

# optimization OK
