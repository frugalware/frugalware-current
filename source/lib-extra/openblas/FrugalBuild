# Compiling Time: 0.01 SBU
# Maintainer: DeX77 <dex77@frugalware.org>

pkgname=openblas
pkgver=0.3.24
pkgrel=1
pkgdesc="An optimized BLAS library based on GotoBLAS2 1.13 BSD"
archs=('x86_64')
groups=('lib-extra')
url="https://www.openblas.net/"
depends=('libgomp')
makedepends=('perl' 'gcc-gfortran')
_F_github_author=xianyi
_F_github_name=OpenBLAS
_F_github_tag_v=y
_F_cmake_confopts="	-DBUILD_SHARED_LIBS=ON \
			-DBUILD_WITHOUT_LAPACK=ON \
			-DBUILD_WITHOUT_CBLAS=ON \
			-DBUILD_TESTING=OFF \
			-DNO_AFFINITY=ON \
			-DUSE_OPENMP=1 \
			-DNO_WARMUP=1 \
			-DCORE=CORE2 \
			-DNUM_THREADS=64 \
			-DDYNAMIC_ARCH=ON"
Finclude github cmake
sha1sums=('86dbb39e6fe0a7fa64e7ba0922f08c6250916a27')
_F_cd_path="OpenBLAS-$pkgver"
provides=('libblas')
conflicts=('libblas')

build() {
	CMake_build
	Fexec cd .. || Fdie
	Fexec rm -rf $_F_cmake_build_dir || Fdie
	CMake_build  -DINTERFACE64=1

	Frm usr/include/cblas.h
	Frm usr/include/lapack*

	Fln libopenblas.so.${pkgver%.*} usr/lib/libblas.so
	Fln libopenblas.so.${pkgver%.*} usr/lib/libblas.so.3

	Fln libopenblas_64.so.${pkgver%.*} usr/lib/libblas64.so
	Fln libopenblas_64.so.${pkgver%.*} usr/lib/libblas64.so.3
	Fln libopenblas_64.so.${pkgver%.*} usr/libopenblas64_.so

	Fln openblas.pc usr/lib/pkgconfig/blas.pc
	Fln openblas64.pc usr/lib/pkgconfig/blas64.pc
}


# optimization OK
