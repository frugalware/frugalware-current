# Compiling Time: 0.01 SBU
# Maintainer: DeX77 <dex77@frugalware.org>

pkgname=wasi-libc
pkgver=20
pkgrel=1
pkgdesc='WASI libc implementation for WebAssembly'
archs=('x86_64')
groups=('lib-extra')
_F_github_author="WebAssembly"
depends=('glibc')
makedepends=('llvm' 'clang')
options=('static')
_F_github_tag=y
_F_github_tag_prefix="wasi-sdk-"
Finclude github
sha1sums=('8678e3510c88ef1de4d8c2940fa8ddad8f4eb084')
_F_cd_path="wasi-libc-wasi-sdk-$pkgver"
_F_make_opts+=" NM=/usr/bin/llvm-nm INSTALL_DIR=$Fdestdir/usr/share/wasi-sysroot BULK_MEMORY_SOURCES="

build() {
	Fbuild
	Fexec find "$Fdestdir/usr/share/wasi-sysroot/lib" -type f -regex '.*\.\(a\|rlib\)' -print -exec llvm-ranlib '{}' ';' || Fdie
}

# optimization OK
