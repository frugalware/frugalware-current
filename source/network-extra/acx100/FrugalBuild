# Compiling Time: ~0.04 SBU
# Maintainer: voroskoi <voroskoi@frugalware.org>

pkgname=acx100
pkgver=0.3.35
pkgrel=19
pkgdesc="The ACX100/ACX111 wireless network driver."
url="http://acx100.erley.org/"
Finclude kernel-module
depends=(${depends[@]} 'wireless_tools')
groups=('network-extra')
archs=('i686' 'x86_64')
up2date="lynx -dump http://acx100.erley.org/current/Changelog|grep '^\[[0-9]\+\] [0-9]'|sed 's/.*] \(.*\)/\1/;q'"
#source=(http://195.66.192.167/linux/acx_patches/acx-20060212.tar.bz2 \
#	http://195.66.192.167/linux/acx_patches/fw.tar.bz2 \
#	http://acx100.erley.org/acx_fw/acx100usb_dlink_dwl120+/fw1/ACX100_USB.bin)
source=(http://ftp.frugalware.org/pub/other/sources/acx100/{acx-20060212.tar.bz2,fw.tar.bz2,ACX100_USB.bin} acx100-0.3.35-linux2619.diff)

build() {
	# no Fcheckkernel, crosscompilation verified
	_F_cd_path="."
	Fpatchall
	sed -i -e "s|usr/share/acx|lib/firmware|g" common.c || Fdie
	make -C $_F_kernelmod_dir/build M=`pwd` || Fdie
	Fmkdir $_F_kernelmod_dir/net
	Ffilerel $_F_kernelmod_dir/net/acx.ko
	Ffile /lib/firmware/ACX100_USB.bin
	Fcd fw
	Ffile fw/acx111_2.3.1.31/* /lib/firmware
	Ffile fw/acx100_1.9.8.b/* /lib/firmware
	Ffile fw/acx100_1.0.9-USB/tiacx100usbc0D /lib/firmware
	Ffile fw/acx111_2.4.0.70-USB/tiacx111usbc1B /lib/firmware
}

# optimalization OK - uses the kernel's option

sha1sums=('06ef53d1b78e6fbefe90bc25f8cb4c5575f27964' \
	  '5b5ef1a9d6441f5f8345e1957cd7686e730897f6' \
	  '6446b0736b6b08e6dc25620f7584e4f7a1a11cb4' \
	  'b93ceee8eb0707ce052434ebab7541bc82eb0dfd')
