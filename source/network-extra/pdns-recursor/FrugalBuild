# Compiling Time: 0.12 SBU
# Maintainer: Karoly CZOVEK <slinky@rei.keni.hu>
# Contributor: Zoltan Kiss <djsmiley@frugalware.org>

pkgname=pdns-recursor
pkgver=3.1.4
pkgrel=2
pkgdesc="Power DNS recursor"
url="http://www.powerdns.com/"
depends=('glibc')
makedepends=('boost>=1.34.0')
groups=('network-extra')
archs=('i686' 'x86_64')
up2date="lynx --dump http://downloads.powerdns.com/releases/?M=D|grep recursor|sed 's/.*recursor-\(.*\).tar.*/\1/;1 q'"
source=(http://downloads.powerdns.com/releases/pdns-recursor-$pkgver.tar.bz2 \
	rc.pdns-recursor recursor.conf atomicity_fix.patch)

build() {
    Fcd $pkgname-$pkgver
    # Fix for gcc4.2.0 atomicity.h problem
    Fpatchall
    Fconf --libdir=/usr/lib/pdns --sysconfdir=/etc/powerdns --enable-pdns_server --enable-recursor --with-pgsql-includes=/usr/include --with-sqlite-includes=/usr/include --with-modules="geo" --with-dynmodules="mysql gmysql gpgsql gsqlite pipe"
    Fmakeinstall
    Fmkdir /etc/powerdns
    Fmkdir /lib/initscripts/messages/hu/LC_MESSAGES
    msgfmt -o $Fdestdir/lib/initscripts/messages/hu/LC_MESSAGES/$pkgname.mo $startdir/hu.po
    Frcd2 pdns-recursor

}

sha1sums=('d1fa344ec5f2feb12397361f92b011a0cb726d48'\
          '78c1bed81bd52a53cab99d30e4970953d85f526b'\
          '8e5c0b594e2c78ad22c101ca77e278308e136ab8'\
          '0ba53bf5ebd8b8f6766d4b06eb4c118c86efd60f')

# optimization OK
