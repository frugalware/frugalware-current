# Compiling Time: 0.12 SBU
# Contributor: kikadf <kikadf.01@gmail.com>
# Contributor: Krisztian VASAS <iron@frugalware.org>
# Contributor: Karoly CZOVEK <slinky@kodollak.hu>
# Contributor: Zoltan Kiss <djsmiley@frugalware.org>

pkgname=pdns-recursor
pkgver=3.6.2
pkgrel=1
pkgdesc="Power DNS recursor"
url="http://www.powerdns.com/"
depends=('libstdc++')
makedepends=('boost>=1.50.0')
groups=('network-extra')
archs=('i686' 'x86_64')
backup=(etc/powerdns/recursor.conf)
up2date="Flasttar $url/downloads.html"
source=(http://downloads.powerdns.com/releases/$pkgname-$pkgver.tar.bz2 \
	pdns-recursor.service recursor.conf)
sha1sums=('69e461eb1da816f82c344137612d056f281217a1' \
          '52189ea6b83e97680de2b488b8c514242ec27368' \
          'faed4e2f9582605456e7579a77f8f80181b260cc')
_F_systemd_units=(pdns-recursor=)
Finclude systemd

build()
{
	Fcd $pkgname-$pkgver
	Fconf \
		--libdir=/usr/lib/pdns \
		--sysconfdir=/etc/powerdns \
		--enable-pdns_server \
		--enable-recursor \
		--with-pgsql-includes=/usr/include \
		--with-sqlite-includes=/usr/include \
		--with-modules="geo" \
		--with-dynmodules="gmysql gpgsql gsqlite pipe"
	make OPTFLAGS="" || Fdie
	Fmakeinstall
	Fmkdir /etc/powerdns
	Fmkdir /lib/initscripts/messages/hu/LC_MESSAGES
	Ffile /etc/powerdns/recursor.conf
	Frm /etc/init.d/
	Ffile /lib/systemd/system/pdns-recursor.service
	Fgenscriptlet
	Frm /etc/powerdns/recursor.conf-dist
}

# optimization OK
