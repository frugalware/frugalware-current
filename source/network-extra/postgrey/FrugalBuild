# Compiling Time: ~0.01 SBU
# Maintainer: CSÉCSY László <boobaa@frugalware.org>

pkgname=postgrey
pkgver=1.29
pkgrel=1
pkgdesc="a Postfix policy server implementing greylisting"
url="http://isg.ee.ethz.ch/tools/postgrey/"
depends=('perl>=5.6.0' 'perl-net-server' 'perl-io-multiplex' 'perl-berkeleydb' 'db>=4.1' 'postfix>=2.1')
groups=('network-extra')
archs=('i686')
up2date="lynx -dump http://isg.ee.ethz.ch/tools/$pkgname/pub/ | grep 'http.*tar\.gz' | sed 's/.*-\(.*\)\.t.*/\1/'"
source=(http://isg.ee.ethz.ch/tools/$pkgname/pub/$pkgname-$pkgver.tar.gz \
        rc.$pkgname rc.$pkgname-hu.po README.Frugalware $pkgname \
	${pkgname}_whitelist_clients ${pkgname}_whitelist_recipients)

build()
{
	Fmkdir usr/{s,}bin
	Fmkdir var/run
	Fmkdir var/spool/postfix/$pkgname
	chown 109 $Fdestdir/var/spool/postfix/$pkgname
	chmod 0700 $Fdestdir/var/spool/postfix/$pkgname
	Fcd $pkgname-$pkgver
	Ffile /etc/postfix/${pkgname}_whitelist_clients
	Ffile /etc/postfix/${pkgname}_whitelist_recipients
#	Fdoc Changes
	Fexerel /usr/sbin/$pkgname
	Fexerel contrib/${pkgname}report usr/bin/
	Ffile /etc/sysconfig/postgrey
	Frcd2 $pkgname
}
# optimization OK - noarch
sha1sums=('648be42d92bd182db0cab5c4b308a8466f9371e6'\
          '74b36884ccc3935dc84e662500e72efbe0748d81'\
          'b078a79443d0807456483f33f64c2ee86bf7367a'\
          '3d5691e5021265ac1667b2254558ca0388e61d9d'\
          '86f3c5c775bda976657b7851c1c35e4ac6711da0'\
          '0401b096b483fe2409729db2f603ee7296241912'\
          '6d451aa84d253c1d3f028414f1ea836fffdb4527')
