# Compiling Time: 0.01 SBU
# Maintainer: voroskoi <voroskoi@frugalware.org>

pkgname=r8169
pkgver=6.004.00
pkgrel=2
Finclude sourceforge kernel-module
pkgdesc="Realtek driver for RTL8169/8110 cards."
url="http://www.realtek.com.tw"
groups=('network-extra')
archs=('i686' 'x86_64')
# remove after 0.8
replaces=('rtl8110')
up2date="lynx -dump ftp://202.65.194.211/cn/nic/ |grep ${pkgname} |Flasttarbz2"
source=(ftp://202.65.194.211/cn/nic/${pkgname}-${pkgver}.tar.bz2 README.Frugalware linux-2.6.23.diff)
sha1sums=('ba75272cfa3740a82aa5f47d7fce8b29795307b7' \
          '21b9e951b8470946d0af2ce1a0527c1d0153dc3f' \
          'dec12bca790f8418f64344998be655ee6dae6aba')

build() {
	unset MAKEFLAGS
	#Fcheckkernel
	Fbuild_kernelmod_scriptlet
	Fmkdir ${_F_kernelmod_dir}/kernel/drivers/net
	Fsed '$(shell uname -r)' "${_F_kernelmod_uname}" src/Makefile
	Fsed 'KMISC\(.*\)/lib\(.*\)' "KMISC\1${Fdestdir}/lib\2" src/Makefile
	Fbuild
	Fmv ${_F_kernelmod_dir}/kernel/drivers/net/{,realtek-}${pkgname}.ko
}
