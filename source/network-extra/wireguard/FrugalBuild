# Compiling Time: 0.17 SBU
# Maintainer: DeX77 <dex77@frugalware.org>

pkgname=wireguard
pkgver=0.0.20191127
pkgrel=4
pkgdesc="Fast, modern, secure VPN tunnel"
url="https://www.wireguard.com/"
groups=('network-extra')
archs=('x86_64')
depends=('libmnl')
up2date="Flasttar https://git.zx2c4.com/WireGuard"
_F_archive_name="WireGuard"
source=("https://git.zx2c4.com/WireGuard/snapshot/WireGuard-${pkgver}.tar.xz"\
	depmod.patch)
signatures=("${source[0]/.xz/.asc}" '')
Finclude kernel-module
_F_cd_path="${_F_archive_name}-$pkgver/src"
_F_make_opts="V=1 \
		KERNELDIR=${_F_kernelmod_dir}/build \
		INSTALL_MOD_PATH=${Fdestdir} \
		WITH_BASHCOMPLETION=yes \
                WITH_WGQUICK=yes \
                WITH_SYSTEMDUNITS=yes"

build() {	
	Fbuild
	Fmkdir lib/systemd/system/
	Fmv usr/lib/systemd/system/wg-quick@.service lib/systemd/system/wg-quick@.service
	Frm usr/lib
	Fbuild_kernelmod_scriptlet
}

# optimization OK
