# Compiling Time: 0.13 SBU
# Maintainer: Michel Hermier <hermier@frugalware.org>

pkgname=nvidia-settings
pkgver=370.28
pkgrel=1
pkgdesc="nVidia settings configuration tool."
url="ftp://download.nvidia.com/XFree86/$pkgname/"
up2date="Flasttar $url"
makedepends=('libxext>=1.3.3-2' 'libglx>=1.18.0' 'libxrandr>=1.5.0-4' \
 	     'libxv>=1.0.10-2' 'gtk+2>=2.24.29-2' 'libvdpau>=1.1.1-2' 'pkgconfig' 'x11-protos>=0.1-5')
depends=('libxxf86vm>=1.1.4-2')
groups=('x11-extra')
archs=('i686' 'x86_64')
source=("$url/$pkgname-$pkgver.tar.bz2" \
	nvidia-settings.desktop \
	nvidia-settings.png)
sha1sums=('9bd75ce391b7408596739e2191000e7e8bd8217c' \
          'ac1f88cc3ea87b1d22e995c2a36f496786198d8a' \
          '6d71a6fdbef74d27de297aeac9dc462a26fe005c')

build()
{
	Fcd
	make clean || Fdie # Package is dirty
	cd src/libXNVCtrl/ || Fdie # Makefile bug
	make clean || Fdie
	make || Fdie
	cd ../.. || Fdie
	Fbuild

	# Install XNVCtrl library.
	Fmkdir /usr/lib/
	Ffilerel src/libXNVCtrl/libXNVCtrl.a /usr/lib/
	Ffilerel src/libXNVCtrl/{NVCtrl,NVCtrlLib}.h /usr/include/NVCtrl/

	# Install documentation
	Fdocrel doc/*.txt

	# Install desktop entry
	Ffile /usr/share/applications/nvidia-settings.desktop
	Ficon nvidia-settings.png
}

# optimization OK
