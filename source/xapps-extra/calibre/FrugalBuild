# Compiling Time: 1.33 SBU
# Maintainer: Melko <melko@frugalware.org>

pkgname=calibre
pkgver=5.6.0
pkgrel=1
pkgdesc="Ebook management application"
url=https://calibre-ebook.com
groups=('xapps-extra')
archs=('x86_64')
depends=('pyqt5' 'podofo' 'hunspell' 'hyphen' 'espeak-ng' \
	'libmtp' 'mathjax' 'pyqtwebengine' 'python3-lxml' \
	'python3-zeroconf' 'python3-regex' 'python3-css-parser' \
	'python3-pillow' 'python3-html5-parser' 'qt5-svg' \
	'python3-beautifulsoup4' 'python3-apsw')
makedepends=('sip5' 'pyqt-builder' 'qt5-base-static' \
	'python3-msgpack' 'python3-dateutil' \
	'python3-six' 'xdg-utils' 'rapydscript-ng')
_F_github_author="kovidgoyal"
_F_github_tag_v=yes
Finclude python github
options=('nostrip')
source=(https://download.calibre-ebook.com/$pkgver/$pkgname-$pkgver.tar.xz \
	icu-68.1.patch)
sha1sums=('f2f39fdceb845d13bedf5bc7cea074d3bcd12582' \
          'd98d3468bb5d69f1e621947ab51d698d71e6eab2')

_F_python_version=python3

build() {
	Fcd
	Fpatchall
	Fmake
	Fexec python3 setup.py gui || Fdie
	Fexec python3 setup.py mathjax --path-to-mathjax /usr/share/mathjax --system-mathjax || Fdie
	Fexec python3 setup.py rapydscript || Fdie
	Fexec python3 setup.py install --staging-root="${Fdestdir}/usr" --prefix=/usr  || Fdie
}

# optimization OK
