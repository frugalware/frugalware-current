# Compiling Time: 0 SBU
# Maintainer: Priyank Gosalia <priyankmg@gmail.com>

pkgname=frostwire
pkgver=4.13.1.7
pkgrel=2
pkgdesc="FrostWire is a Peer to Peer (P2P) information sharing client for the Gnutella network."
Finclude sourceforge
url="http://www.frostwire.com"
rodepends=('j2re')
depends=()
groups=('xapps-extra')
archs=('i686' 'x86_64')
up2date="lynx -dump $url | grep Version | sed 's/.*n \(.*\)*/\1/'"
source=(http://www2.frostwire.com/frostwire/90627762/$pkgname-$pkgver.noarch.tar.gz \
	http://www.frostwire.com/images/64x64frostsphere.png)
sha1sums=('097194f8e01d74adb9c3a4000085883d83963d8d'\
          '3492e5611436bd44e17d29b5b323879b836efcdb')

build()
{
	Fcd $pkgname-${pkgver/.7/.6.noarch}
	Fmkdir usr/share/{frostwire,applications,pixmaps}
	mv $Fsrcdir/64x64frostsphere.png $Fdestdir/usr/share/pixmaps/$pkgname.png
	## clean up 
	find . -name ".svn"|xargs rm -rf 
	cp -r * $Fdestdir/usr/share/frostwire
	
	# Fix LFs and CRs in runFrost.sh
	sed -i 's/[^ -~]//g' $Fdestdir/usr/share/frostwire/runFrostwire.sh
	
	# Create an executable script for frostwire
	Fmkdir /usr/bin
	echo "#!/bin/sh" >> $Fdestdir/usr/bin/frostwire
	echo "cd /usr/share/frostwire" >> $Fdestdir/usr/bin/frostwire
	echo "sh runFrostwire.sh" >> $Fdestdir/usr/bin/frostwire
	chmod 755 $Fdestdir/usr/bin/frostwire

	Fmv /usr/share/frostwire/frostwire.desktop /usr/share/applications
	Fsed "Icon=.*" "Icon=/usr/share/pixmaps/$pkgname.png" \
		$Fdestdir/usr/share/applications/$pkgname.desktop
	# Remove unwanted files
	Frm /usr/share/frostwire/{runFrostwireOSX.sh,COPYING,changelog}
}

