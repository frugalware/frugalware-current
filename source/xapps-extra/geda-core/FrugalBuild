# Compiling Time: 0.33 SBU
# Maintainer: Priyank Gosalia <priyankmg@gmail.com>

pkgname=geda-core
_F_archive_name=geda-utils # Reference archive for package version
pkgver=1.4.3
pkgrel=2
pkgdesc="Core components for gEDA - A complete electronic design and automation suite."
url="http://geda.seul.org/"
dlurl="ftp://ftp.geda.seul.org/pub/geda/release/v1.4/$pkgver/"
license="GPL-2"
depends=('gtk+2' 'guile' 'libgeda>=1.4.3' 'desktop-file-utils')
makedepends=('intltool' 'perl-xml-parser')
groups=('xapps-extra' 'geda-suite')
options=('scriptlet')
archs=('i686' 'x86_64')
up2date="lynx -dump $url/sources.html | grep -m1 geda-docs | sed 's/.*s-\(.*\).t.*/\1/'"
source=($dlurl/geda-gattrib-$pkgver.tar.gz \
	$dlurl/geda-gnetlist-$pkgver.tar.gz \
	$dlurl/geda-gschem-$pkgver.tar.gz \
	$dlurl/geda-gsymcheck-$pkgver.tar.gz \
	$dlurl/geda-symbols-$pkgver.tar.gz \
	$dlurl/geda-utils-$pkgver.tar.gz \
	$dlurl/geda-docs-$pkgver.tar.gz \
	$dlurl/geda-examples-$pkgver.tar.gz)
Fconfopts="${Fconfopts[@]} --disable-dependency-tracking \
	--with-doc-dir=$Fprefix/share/doc/$pkgname \
	--with-pcbconfdir=$Fprefix/share/pcb \
	--with-pcbm4dir=$Fprefix/share/pcb/m4"
_F_gnome_desktop="y"
_F_gnome_iconcache="y"
Finclude gnome-scriptlet
sha1sums=('f3886a41abaddd444eea21e4000b5c495accb85c' \
          '8d44d7af1875e1d1a07b6e6f7b7fb8f3dc061283' \
          'ae6c0b6955d0de125cb588379eecab77dd4f288d' \
          '62fa370d79178660f8f16696296b40683f275d18' \
          '1a496d4dc35863e48def504e0970a396ddc69a68' \
          '3f9e8d3443ba804168d91bffb21165382c6b4219' \
          'dda5b33b2df4486f3cdc930d771880b8f6bba3c0' \
          'b9a5684d0e9e7c93ddfe521a3133691b3f48f682')

build()
{
	for directory in geda-{gattrib,gnetlist,gschem,gsymcheck,symbols,utils,docs}-$pkgver; do
		Fmessage "Building gEDA:${directory}"
		cd ${Fsrcdir}/${directory} || Fdie
		./configure $Fconfopts || Fdie
		make || Fdie
		make DESTDIR=$Fdestdir install || Fdie
	done

	Frm /usr/share/gEDA/sym/gnetman

	# Install examples
	Fmessage "Copying examples..."
	Fmkdir /usr/share/gEDA/examples
	cd $Fsrcdir || Fdie
	cp -dpr geda-examples-$pkgver/* $Fdestdir/usr/share/gEDA/examples/
	Ffileschmod /usr/share/gEDA/examples 644
	Fbuild_gnome_scriptlet
}

# optimization OK
