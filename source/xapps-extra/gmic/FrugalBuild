# Compiling Time: 12.85 SBU
# Maintainer: DeX77 <dex77@frugalware.org>
# Contributor: Devil505 <devil505linux@gmail.com>

pkgname=gmic
pkgver=2.9.0
pkgrel=2
pkgdesc="Image procession framework"
depends=('curl' 'opencv>=4.3.0')
makedepends=('x11-protos')
groups=('xapps-extra')
archs=('x86_64')
url="https://gmic.eu"
Fpkgversep="_"
up2date="Flasttar $url/files/source/"
source=("$url/files/source/gmic_$pkgver.tar.gz" \
	build-fixes.patch \
	opencv4.patch)
sha1sums=('f1c4dd0c58548828fe57ca6685b384ae086f45bf' \
          '1631dd685d83955494b5c964da9af41314cf30fe' \
          '4c0c33ec6274738a56d02a22726a59c7480e6328')
_F_cd_path="gmic-$pkgver"

subpkgs+=("gimp-plugin-gmic")
subdescs+=("Gimp plugin for the GMIC image procession framework")
subdepends+=("gimp qt5-base")
subgroups+=('xapps-extra')
subarchs+=('x86_64')

build()
{
	Fcd
	Fpatchall

	make -C src all  WGET=/bin/true -j1 || Fdie
	make -C src install DESTDIR="$Fdestdir" USR=/usr || Fdie

	# gimp plugin
	Fsplit gimp-plugin-gmic usr/lib/gimp/2.0/plug-ins/gmic_gimp_qt
}


# optimization OK
