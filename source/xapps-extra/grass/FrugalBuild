# Compiling time: 1.91 SBU
# Maintainer: Janny <janny@frugalware.org>

pkgname=grass
pkgver=6.2.1
pkgrel=2
pkgdesc="GRASS - Geographic Resources Analysis Support System"
url="http://grass.itc.it"
license="GPL"
depends=('libtiff' 'freetype2' 'libsm' 'ncurses' 'libstdc++' 'libpng' 'tk' 'gdal' 'proj' 'mesa')
makedepends=('bison' 'flex' 'libjpeg' 'libpng' 'zlib' 'fftw')
archs=('i686' 'x86_64')
groups=('xapps-extra')
up2date="lynx -dump $url/download/ |grep $pkgname-[0-9\.]*\.*.tar.gz$ |sed -n 's/.*-\(.*\)\.t.*/\1/;1 p'"
source=($url/grass62/source/$pkgname-$pkgver.tar.gz)
sha1sums=('bbd179b9145d735873a13f40a25784b64762387b')

build() {
	unset MAKEFLAGS
	export CFLAGS="$CFLAGS -I/usr/include/gdal"
	Fbuild --prefix=$Fdestdir/usr --bindir=$Fdestdir/usr/bin \
	--enable-shared --with-cxx --with-gdal=/usr/bin/gdal-config \
	--with-postgres=no --without-odbc --with-fftw --with-nls \
	--with-freetype --with-freetype-includes=/usr/include/freetype2
	Fsed "GISBASE=.*$" "GISBASE=/usr/grass-$pkgver" $Fdestdir/usr/bin/grass62
}

# optimization OK
