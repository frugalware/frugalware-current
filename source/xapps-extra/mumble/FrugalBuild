# Compiling Time: 0.76 SBU
# Maintainer: gholafox <gholafox@free.fr>
# Contributor: Devil505 <devil505linux@gmail.com>

pkgname=mumble
pkgver=1.2.2
pkgrel=3
pkgdesc="A voice chat application similar to TeamSpeak"
rodepends=('qt4-plugin-sqlite3')
depends=('qt4-qdbus' 'speex' 'openssl>=1.0.0' 'alsa-lib' 'libqtsql' 'libqtopengl' 'libqtnetwork' 'libgl' 'libice' 'libxext' 'libxdamage' 'libsndfile' 'libglu' 'avahi-compat' 'protobuf' 'celt')
makedepends=('pkgconfig' 'boost>=1.39.0-5' 'qt4-linguist')
options=('scriptlet')
_F_sourceforge_realname="Mumble"
_F_gnome_iconcache="y"
Finclude sourceforge gnome-scriptlet
groups=('xapps-extra')
archs=('i686' 'x86_64')
sha1sums=('b2a7fd50e70147b3ea2361cbc5a577b0e1ae45ea')

build() {
  Fcd

  # Building mumble
  /usr/bin/qmake main.pro \
    CONFIG+="no-bundled-speex no-speechd no-g15 no-xevie no-server" \
    DEFINES+="PLUGIN_PATH=/usr/lib/$pkgname/plugins" || Fdie
  Fmake

  # create directories and copy files
  Fexerel ./release/$pkgname usr/bin/$pkgname
  Fexerel ./scripts/$pkgname-overlay usr/bin/$pkgname-overlay
  Fmkdir usr/lib/$pkgname/plugins
  Fexerel ./release/libmumble.so.$pkgver usr/lib/$pkgname/
  Fln libmumble.so.$pkgver usr/lib/$pkgname/libmumble.so
  Fln libmumble.so.$pkgver usr/lib/$pkgname/libmumble.so.1
  Fln libmumble.so.$pkgver usr/lib/$pkgname/libmumble.so.1.1
  Fexerel ./release/plugins/liblink.so usr/lib/$pkgname/plugins/
  Finstallrel 644 ./scripts/$pkgname.desktop usr/share/applications/$pkgname.desktop
  Finstallrel 644 ./man/mum* usr/share/man/man1/
  #Finstallrel 644 ./icons/$pkgname.16x16.png usr/share/icons/hicolor/16x16/apps/$pkgname.png
  #Finstallrel 644 ./icons/$pkgname.32x32.png usr/share/icons/hicolor/32x32/apps/$pkgname.png
  #Finstallrel 644 ./icons/$pkgname.48x48.png usr/share/icons/hicolor/48x48/apps/$pkgname.png
  #Finstallrel 644 ./icons/$pkgname.64x64.png usr/share/icons/hicolor/64x64/apps/$pkgname.png

  Fbuild_gnome_scriptlet
}

# optimization OK
