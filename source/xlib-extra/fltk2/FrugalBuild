# Compiling time: 0.45 SBU
# Maintainer: crazy <crazy@frugalware.org>

pkgname=fltk2
pkgver=r6786
origname=fltk-2.0.x-${pkgver}
pkgrel=2
pkgdesc="FLTK2 is a cross-platform C++ GUI toolkit for X."
url="http://www.fltk.org/"
depends=('libxi' 'libxinerama' 'libjpeg>=8a' 'cairo>=1.8.6-3' 'libxft>=2.1.13-2' 'libgcc')
makedepends=('doxygen')
options=('scriptlet')
groups=('xlib-extra')
archs=('i686' 'x86_64' 'ppc')
up2date="lynx -dump http://www.fltk.org/|grep -m1 'VERSION=2'|sed 's/.*=2.*.x-\(.*\).*/\1/'"
source=(http://ftp.easysw.com/pub/fltk/snapshots/$origname.tar.bz2 \
	disable_crappy_test.patch fixGcc43.diff fltk2-gcc44.patch)
sha1sums=('b3bfcff643b4b6a05ed377ad87bc4b8487ee1a37' \
          '007ac0c6e19ea5afa4c8e7eb34bf480ab2f18f74' \
          '1e7c5a3e4aa1a10d78daa99b66d474bef7d61192' \
          'b486d2eebdfaa549f4b81663625c68b81aeb37df')

build()
{
	Fcd $origname
	Fpatchall
	autoconf || return 1
	Fsed '$(bindir)/fltk2-config --post' \
	     '$(DESTDIR)$(bindir)/fltk2-config --post' fluid/Makefile
	CFLAGS="$CFLAGS" CXXFLAGS="$CXXFLAGS" \
	./configure $Fconfopts --enable-threads --enable-xft \
	       --with-x --enable-cairo \
	       --with-optim="$CXXFLAGS -fno-strict-aliasing" \
	       --enable-shared
	make || Fdie
	Fmakeinstall
	## lalala not - implemented  - heh
	## man pages missing as well but I don't write any :-P
	## themes broken
	cd documentation || Fdie
	doxygen || Fdie
	cd .. || Fdie
	Fmkdir usr/share/doc/$pkgname-$pkgver
	cp -Ra documentation $Fdestdir/usr/share/doc/$pkgname-$pkgver/ || Fdie
}
