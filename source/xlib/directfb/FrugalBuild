# Compiling Time: 0.75 SBU
# Maintainer: Priyank Gosalia <priyankmg@gmail.com>

pkgname=directfb
pkgver=1.0.0
_pkgver=1.0-0
pkgrel=1
pkgdesc="A thin library that provides hardware graphics acceleration, input device handling and abstraction, integrated windowing system on top of the Linux Framebuffer Device."
url="http://www.directfb.org"
license="LGPL"
depends=('sdl' 'sysfsutils' 'freetype2' 'libpng' 'libjpeg' 'libmpeg3' 'zlib')
groups=('xlib')
archs=('i686' 'x86_64')
up2date="lynx -dump http://directfb.org/index.php?path=Main%2FDownloads | grep -m1 tar.gz | sed 's/.*B-\(.*\).t.*/\1/'"
source=(http://www.directfb.org/downloads/Core/DirectFB-$pkgver.tar.gz \
	directfb-0.9.25.1-sysfs.diff)
sha1sums=('8ac354cabd9c279e8bd3cf352daddf1b19f2007f' \
          'edcd80bcc94f4e0370b2e39c12335f5eb5d8869d')

subpkgs=("$pkgname-video-i810" "$pkgname-video-i830" "$pkgname-video-mga" "$pkgname-video-nv" "$pkgname-video-savage" \
	"$pkgname-video-sis" "$pkgname-video-neomagic" "$pkgname-video-ati" "$pkgname-video-nsc" \
	"$pkgname-video-tdfx" "$pkgname-video-unichrome" "$pkgname-video-radeon" "$pkgname-input-joystick" \
	"$pkgname-input-keyboard" "$pkgname-input-ps2mouse" "$pkgname-input-serialmouse" \
	"$pkgname-input-linuxinput" "$pkgname-input-lirc" "$pkgname-input-mutouch" "$pkgname-input-penmount" \
	"$pkgname-input-sonypi" "$pkgname-input-wm97xx")
subdescs=('DirectFB video driver for Intel i810 cards' \
	'DirectFB video driver for Intel i830 cards' \
	'DirectFB video driver for Matrox cards' \
	'DirectFB video driver for NVidia cards' \
	'DirectFB video driver for S3 Savage cards' \
	'DirectFB video driver for SiS cards' \
	'DirectFB video driver for NeoMagic cards' \
	'DirectFB video driver for ATI cards' \
	'DirectFB video driver for nsc cards' \
	'DirectFB video driver for 3dfx Voodoo cards' \
	'DirectFB video driver for Unichrome cards' \
	'DirectFB video driver for ATI Radeon cards' \
	'DirectFB driver for joystick input devices' \
	'DirectFB driver for keyboard input devices' \
	'DirectFB driver for PS/2 mouse input devices' \
	'DirectFB driver for serial mouse input devices' \
	'DirectFB driver for linux input devices' \
	'DirectFB driver for lirc input devices' \
	'DirectFB driver for mutouch input devices' \
	'DirectFB driver for penmount input devices' \
	'DirectFB driver for sonypi input devices' \
	'DirectFB driver for wm97xx_ts input devices')
subdepends=("$pkgname=$pkgver" "$pkgname=$pkgver" "$pkgname=$pkgver" "$pkgname=$pkgver" \
	"$pkgname=$pkgver" "$pkgname=$pkgver" "$pkgname=$pkgver" "$pkgname=$pkgver" \
	"$pkgname=$pkgver" "$pkgname=$pkgver" "$pkgname=$pkgver" "$pkgname=$pkgver" \
	"$pkgname=$pkgver" "$pkgname=$pkgver" "$pkgname=$pkgver" "$pkgname=$pkgver" \
	"$pkgname=$pkgver" "$pkgname=$pkgver" "$pkgname=$pkgver" "$pkgname=$pkgver" \
	"$pkgname=$pkgver" "$pkgname=$pkgver")
subgroups=('xlib directfb-drivers' 'xlib directfb-drivers' 'xlib directfb-drivers' 'xlib directfb-drivers' \
	'xlib directfb-drivers' 'xlib directfb-drivers' 'xlib directfb-drivers' 'xlib directfb-drivers' \
	'xlib directfb-drivers' 'xlib directfb-drivers' 'xlib directfb-drivers' 'xlib directfb-drivers' \
	'xlib directfb-drivers' 'xlib directfb-drivers' 'xlib directfb-drivers' 'xlib directfb-drivers' \
	'xlib directfb-drivers' 'xlib directfb-drivers' 'xlib directfb-drivers' 'xlib directfb-drivers' \
	'xlib directfb-drivers' 'xlib directfb-drivers')
subarchs=('i686 x86_64' 'i686 x86_64' 'i686 x86_64' 'i686 x86_64' 'i686 x86_64' 'i686 x86_64' \
	'i686 x86_64' 'i686 x86_64' 'i686 x86_64' 'i686 x86_64' 'i686 x86_64' 'i686 x86_64' \
	'i686 x86_64' 'i686 x86_64' 'i686 x86_64' 'i686 x86_64' 'i686 x86_64' 'i686 x86_64' \
	'i686 x86_64' 'i686 x86_64' 'i686 x86_64' 'i686 x86_64')

build() {
	Fcd DirectFB-$pkgver
	sed -i '/-O3/d' configure || return 1
	Fbuild --enable-x11 --enable-zlib --enable-sdl --enable-mmx --enable-sse \
	--enable-jpeg --enable-png --enable-freetype --enable-sysfs --enable-static \
	--enable-debug --disable-vnc --enable-fbdev --enable-fbcon \
	--with-input-drivers=keyboard,joystick,ps2mouse,serialmouse,linuxinput \
	--with-gfx-drivers=i810,i830,matrox,nvidia,sis315,neomagic,savage,ati128

	# Graphics drivers
	Fsplit $pkgname-video-i810 usr/lib/$pkgname-$_pkgver/gfxdrivers/libdirectfb_i810.{a,la,o,so}
	Fsplit $pkgname-video-i830 usr/lib/$pkgname-$_pkgver/gfxdrivers/libdirectfb_i830.{a,la,o,so}
	Fsplit $pkgname-video-mga usr/lib/$pkgname-$_pkgver/gfxdrivers/libdirectfb_matrox.{a,la,o,so}
	Fsplit $pkgname-video-nv usr/lib/$pkgname-$_pkgver/gfxdrivers/libdirectfb_nvidia.{a,la,o,so}
	Fsplit $pkgname-video-savage usr/lib/$pkgname-$_pkgver/gfxdrivers/libdirectfb_savage.{a,la,o,so}
	Fsplit $pkgname-video-sis usr/lib/$pkgname-$_pkgver/gfxdrivers/libdirectfb_sis315.{a,la,o,so}
	Fsplit $pkgname-video-neomagic usr/lib/$pkgname-$_pkgver/gfxdrivers/libdirectfb_neomagic.{a,la,o,so}
	Fsplit $pkgname-video-ati usr/lib/$pkgname-$_pkgver/gfxdrivers/libdirectfb_ati128.{a,la,o,so}
	Fsplit $pkgname-video-nsc usr/lib/$pkgname-$_pkgver/gfxdrivers/libdirectfb_nsc.{a,la,o,so}
	Fsplit $pkgname-video-tdfx usr/lib/$pkgname-$_pkgver/gfxdrivers/libdirectfb_tdfx.{a,la,o,so}
	Fsplit $pkgname-video-unichrome usr/lib/$pkgname-$_pkgver/gfxdrivers/libdirectfb_unichrome.{a,la,o,so}
	Fsplit $pkgname-video-radeon usr/lib/$pkgname-$_pkgver/gfxdrivers/libdirectfb_radeon.{a,la,o,so}
	
	# Input drivers
	Fsplit $pkgname-input-joystick usr/lib/$pkgname-$_pkgver/inputdrivers/libdirectfb_joystick.{a,la,o,so}
	Fsplit $pkgname-input-keyboard usr/lib/$pkgname-$_pkgver/inputdrivers/libdirectfb_keyboard.{a,la,o,so}
	Fsplit $pkgname-input-serialmouse usr/lib/$pkgname-$_pkgver/inputdrivers/libdirectfb_serialmouse.{a,la,o,so}
	Fsplit $pkgname-input-ps2mouse usr/lib/$pkgname-$_pkgver/inputdrivers/libdirectfb_ps2mouse.{a,la,o,so}
	Fsplit $pkgname-input-linuxinput usr/lib/$pkgname-$_pkgver/inputdrivers/libdirectfb_linux_input.{a,la,o,so}
	Fsplit $pkgname-input-lirc usr/lib/$pkgname-$_pkgver/inputdrivers/libdirectfb_lirc.{a,la,o,so}
	Fsplit $pkgname-input-mutouch usr/lib/$pkgname-$_pkgver/inputdrivers/libdirectfb_mutouch.{a,la,o,so}
	Fsplit $pkgname-input-penmount usr/lib/$pkgname-$_pkgver/inputdrivers/libdirectfb_penmount.{a,la,o,so}
	Fsplit $pkgname-input-sonypi usr/lib/$pkgname-$_pkgver/inputdrivers/libdirectfb_sonypi.{a,la,o,so}
	Fsplit $pkgname-input-wm97xx usr/lib/$pkgname-$_pkgver/inputdrivers/libdirectfb_wm97xx_ts.{a,la,o,so}
}

# optimization OK
