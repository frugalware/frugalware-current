From a579e3bc6de3c6da245ce70b9a1653f9b7fd0097 Mon Sep 17 00:00:00 2001
From: Benjamin Otte <otte@redhat.com>
Date: Mon, 23 Oct 2023 02:52:04 +0200
Subject: [PATCH] build: Fix up header includes

These weren't fixed in the merge request in
  https://gitlab.gnome.org/GNOME/gtk/-/merge_requests/6489
to the change from
  https://gitlab.gnome.org/GNOME/gtk/-/merge_requests/6514
---
 gdk/gdkdmabufegl.c            | 4 +++-
 gdk/gdkglcontext.c            | 2 +-
 testsuite/gdk/dmabuftexture.c | 2 +-
 3 files changed, 5 insertions(+), 3 deletions(-)

diff --git a/gdk/gdkdmabufegl.c b/gdk/gdkdmabufegl.c
index 1f5a8213ced..397fe28585d 100644
--- a/gdk/gdkdmabufegl.c
+++ b/gdk/gdkdmabufegl.c
@@ -33,7 +33,7 @@
 #include <sys/mman.h>
 #include <sys/ioctl.h>
 #include <linux/dma-buf.h>
-#include <drm/drm_fourcc.h>
+#include <drm_fourcc.h>
 #include <epoxy/egl.h>
 
 /* A dmabuf downloader implementation that downloads buffers via
@@ -187,7 +187,9 @@ get_memory_format (guint32  fourcc,
     case DRM_FORMAT_UYVY:
     case DRM_FORMAT_VYUY:
     case DRM_FORMAT_XYUV8888:
+#ifdef DRM_FORMAT_XVUY8888
     case DRM_FORMAT_XVUY8888:
+#endif
     case DRM_FORMAT_VUY888:
       return GDK_MEMORY_R8G8B8;
 
diff --git a/gdk/gdkglcontext.c b/gdk/gdkglcontext.c
index 7993879e851..725cb5860c4 100644
--- a/gdk/gdkglcontext.c
+++ b/gdk/gdkglcontext.c
@@ -97,7 +97,7 @@
 #endif
 
 #ifdef HAVE_DMABUF
-#include <drm/drm_fourcc.h>
+#include <drm_fourcc.h>
 #endif
 
 #include <math.h>
diff --git a/testsuite/gdk/dmabuftexture.c b/testsuite/gdk/dmabuftexture.c
index e939bc4867d..d56fb29ef0b 100644
--- a/testsuite/gdk/dmabuftexture.c
+++ b/testsuite/gdk/dmabuftexture.c
@@ -6,7 +6,7 @@
 #include <gdk/gdkdmabuftextureprivate.h>
 
 #ifdef HAVE_DMABUF
-#include <drm/drm_fourcc.h>
+#include <drm_fourcc.h>
 #endif
 
 static void
-- 
GitLab

