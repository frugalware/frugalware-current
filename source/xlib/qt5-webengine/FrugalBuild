# Compiling Time: 64.56 SBU
# Maintainer: Marius Cirsta <mcirsta@frugalware.org>

pkgname=qt5-webengine
pkgver=5.7.1
pkgrel=1
depends=('qt5-declarative>=5.7.1' 'qt5-webchannel>=5.7.1' 'qt5-location>=5.7.1' 'libxcomposite>=0.4.4-3' \
	'libxrandr>=1.5.0-5' 'nss>=3.26' 'libxtst>=1.2.2-3' 'libxscrnsaver>=1.2.2-3' 'zlib>=1.2.8-8' 'libwebp>=0.5.1-2' \
	'libxml2>=2.9.4-3' 'libevent>=2.0.22-4' 'jsoncpp>=1.7.5' 'opus>=1.1.3-2' 'libvpx>=1.6.0-2' 'snappy>=1.1.3-4' \
	'icu4c>=58.1' 'ffmpeg>=3.2' 'libsrtp>=1.5.4-4' )
makedepends=('git' 're2c>=0.16-2' 'x11-protos')
Finclude qt5
archs=("x86_64")
replaces=('libqt5webengine')
conflicts=("${replaces[@]}")
provides=("${replaces[@]}")
sha1sums=('758390df92c80fa72ff5df4228b443d5b460a7f0')

CXXFLAGS+=" -Wno-deprecated -Wno-deprecated-declarations"

build()
{

	## FIXME use more system-* stuff
	Fpatchall
	## crash with eg:
	## http://www.mega-device.com/bateriya_za_nokia_6300_(bl_4c)_Product_1550.html
	Fsed "use_system_libjpeg=1" "use_system_libjpeg=0" src/core/config/linux.pri

	qmake-qt5 -d WEBENGINE_CONFIG+=" use_proprietary_codecs use_system_ffmpeg"
	make || Fdie
	make INSTALL_ROOT=$Fdestdir install || Fdie

}

# optimization OK
