# Compiling Time: 64.56 SBU
# Maintainer: DeX77 <dex77@frugalware.org>

pkgname=qt6-webengine
pkgver=6.7.1
pkgrel=2
depends=('qt6-positioning' 'qt6-webchannel' 'nss' 'libjpeg-turbo' 'libatomic' 'libvpx' 're2'\
	'libxcomposite' 'libxcursor' 'libxrandr' 'libxshmfence' 'libepoxy' 'icu4c>=75.1' 'libva' \
	'ffmpeg>=7.0' 'opus' 'snappy>=1.2.0' 'libevent' 'libxslt' 'libgbm' 'libkrb5' 'libxkbfile')
_F_cmake_confopts="	-DCMAKE_TOOLCHAIN_FILE=/usr/lib/cmake/Qt6/qt.toolchain.cmake \
			-DQT_FEATURE_webengine_system_ffmpeg=ON \
			-DQT_FEATURE_webengine_system_icu=ON \
			-DQT_FEATURE_webengine_system_libvpx=ON \
			-DQT_FEATURE_webengine_system_re2=ON \
			-DQT_FEATURE_webengine_system_libevent=ON \
			-DQT_FEATURE_webengine_proprietary_codecs=ON \
			-DQT_FEATURE_webengine_kerberos=ON \
			-DQT_FEATURE_webengine_webrtc_pipewire=ON"
Finclude qt6
source+=(qtwebengine-6.7.0-ninja1.12.patch \
	no-h264.patch \
	qtwebengine-ffmpeg-7.patch)
sha1sums=('60016c8b55f7fd376e3d809a162bd07004c529f3' \
          'fff930d9eadfab4e21cf1c85bc7eebe96f3d78d5' \
          '13c73ac3fb920ea9e970b67d32dce2745f5879a6' \
          '452bc2ef6ceeeb9003dc5e1f2495ee265e001840')
makedepends+=('qt6-websockets' 'qt6-tools' 'x11-protos' 'nodejs' 'html5lib-python' \
	'cups' 'pipewire' 'gn' 'python3-six' 'python3-zombie-imp' 'qt6-declarative-static')

build() {
	Fcd
	Fexec rm src/3rdparty/chromium/third_party/six/src/six.py
	Fexec rm src/3rdparty/chromium/third_party/catapult/third_party/six/six.py
	Fexec rm src/3rdparty/chromium/third_party/wpt_tools/wpt/tools/third_party/six/six.py
	CMake_build
}
# optimization OK
