From: Christian Marillat <marillat@debian.org>
Date: Tue, 17 Apr 2018 21:11:53 +0200
Subject: Remove embedded/downloaded copies of various libraries

Once this is acceptable, this should be forwarded upstream so that the
use of system libraries is an option, instead of downloading libraries
and programs at build time.
---
 libhb/module.defs      |  8 ++------
 make/include/main.defs | 29 -----------------------------
 test/module.defs       |  8 ++++++--
 3 files changed, 8 insertions(+), 37 deletions(-)

diff --git a/libhb/module.defs b/libhb/module.defs
index 67eb1a3..f20d387 100644
--- a/libhb/module.defs
+++ b/libhb/module.defs
@@ -1,7 +1,7 @@
 __deps__ := A52DEC BZIP2 LIBVPX SVT-AV1 FFMPEG FREETYPE LAME LIBASS LIBDCA \
     LIBDVDREAD LIBDVDNAV LIBICONV LIBSAMPLERATE LIBTHEORA LIBVORBIS LIBOGG \
     LIBXML2 X264 X265 ZLIB LIBBLURAY FDKAAC LIBVPL LIBGNURX JANSSON \
-    HARFBUZZ LIBOPUS LIBSPEEX LIBDAV1D LIBJPEGTURBO LIBDOVI
+    HARFBUZZ LIBOPUS LIBSPEEX LIBDOVI
 
 ifeq (,$(filter $(HOST.system),darwin cygwin mingw))
     __deps__ += FONTCONFIG
@@ -133,7 +133,7 @@ LIBHB.lib = $(LIBHB.build/)hb.lib
 LIBHB.dll.libs = $(foreach n, \
         ass avformat avfilter avcodec avutil swresample postproc dvdnav dvdread \
         freetype mp3lame swscale vpx theora vorbis vorbisenc ogg x264 xml2 \
-        bluray jansson harfbuzz opus speex dav1d turbojpeg zimg SvtAv1Enc, \
+        bluray jansson harfbuzz opus speex turbojpeg SvtAv1Enc, \
         $(CONTRIB.build/)lib/lib$(n).a )
 
 ifeq (1,$(FEATURE.fdk_aac))
@@ -145,10 +145,6 @@ LIBHB.GCC.D += ONEVPL_EXPERIMENTAL
 LIBHB.dll.libs += $(CONTRIB.build/)lib/libvpl.a
 endif
 
-ifeq (1,$(FEATURE.x265))
-LIBHB.dll.libs += $(CONTRIB.build/)lib/libx265.a
-endif
-
 ifeq (1,$(FEATURE.libdovi))
 LIBHB.dll.libs += $(CONTRIB.build/)lib/libdovi.a
 endif
diff --git a/make/include/main.defs b/make/include/main.defs
index 54cbb1c..e5a6faa 100644
--- a/make/include/main.defs
+++ b/make/include/main.defs
@@ -42,35 +42,10 @@ ifeq (1,$(FEATURE.fdk_aac))
     MODULES += contrib/fdk-aac
 endif
 
-ifeq (1,$(FEATURE.x265))
-    MODULES += contrib/x265
-    MODULES += contrib/x265_8bit
-    MODULES += contrib/x265_10bit
-    MODULES += contrib/x265_12bit
-endif
-
-MODULES += contrib/libdav1d
-MODULES += contrib/svt-av1
-MODULES += contrib/zimg
-MODULES += contrib/ffmpeg
-MODULES += contrib/libdvdread
-MODULES += contrib/libdvdnav
-MODULES += contrib/libbluray
-
-ifeq (1,$(FEATURE.qsv))
-ifeq (,$(filter $(HOST.system),freebsd))
-    MODULES += contrib/libvpl
-endif
-endif
-
 ifeq (1,$(FEATURE.vce))
     MODULES += contrib/amf
 endif
 
-ifeq (1,$(FEATURE.nvenc))
-    MODULES += contrib/nvenc
-endif
-
 ifeq (1,$(FEATURE.libdovi))
     MODULES += contrib/libdovi
 endif
@@ -80,10 +55,6 @@ ifneq (,$(filter $(HOST.system),darwin))
     MODULES += contrib/bin2c
 endif
 
-ifneq (,$(filter $(HOST.machine),arm64 aarch64))
-    MODULES += contrib/sse2neon
-endif
-
 ifneq (,$(filter $(HOST.system),cygwin mingw))
 ifneq ($(HAS.iconv),1)
     MODULES += contrib/libiconv
diff --git a/test/module.defs b/test/module.defs
index a94f811..8564dbe 100644
--- a/test/module.defs
+++ b/test/module.defs
@@ -16,13 +16,17 @@ TEST.libs = $(LIBHB.a)
 TEST.GCC.l = \
         ass avformat avfilter avcodec avutil swresample postproc mp3lame dvdnav \
         dvdread fribidi swscale vpx theoraenc theoradec vorbis vorbisenc ogg \
-        x264 bluray freetype xml2 bz2 z jansson harfbuzz opus speex lzma dav1d \
-        turbojpeg zimg SvtAv1Enc
+        x264 bluray freetype xml2 bz2 z jansson harfbuzz opus speex lzma \
+        turbojpeg SvtAv1Enc
 
 ifeq (,$(filter $(HOST.system),darwin cygwin mingw))
     TEST.GCC.l += fontconfig
 endif
 
+ifeq (1,$(FEATURE.x265))
+    TEST.GCC.l += x265
+endif
+
 ifeq (1,$(FEATURE.qsv))
     TEST.GCC.l += vpl
 ifneq (,$(filter $(HOST.system),linux freebsd))
