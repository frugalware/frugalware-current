From 9c0dd8ef60a2562af31e63f0dedc83e71dcdf9d9 Mon Sep 17 00:00:00 2001
From: Mathieu Duponchelle <mathieu@centricular.com>
Date: Thu, 12 Jul 2018 21:57:57 +0200
Subject: [PATCH 45/72] avcfg: add skip support to overrides system

https://bugzilla.gnome.org/show_bug.cgi?id=792900
---
 ext/libav/gstavcfg.c | 10 ++++++++--
 1 file changed, 8 insertions(+), 2 deletions(-)

diff --git a/ext/libav/gstavcfg.c b/ext/libav/gstavcfg.c
index 0a5baa0..3f98da2 100644
--- a/ext/libav/gstavcfg.c
+++ b/ext/libav/gstavcfg.c
@@ -219,8 +219,14 @@ install_opts (GObjectClass * gobject_class, const AVClass ** obj, guint prop_id,
     const gchar *name;
 
     if (overrides && g_hash_table_contains (overrides, opt->name)) {
-      name =
-          gst_structure_get_name (g_hash_table_lookup (overrides, opt->name));
+      gboolean skip;
+      const GstStructure *s =
+          (GstStructure *) g_hash_table_lookup (overrides, opt->name);
+
+      name = gst_structure_get_name (s);
+      if (gst_structure_get_boolean (s, "skip", &skip) && skip) {
+        continue;
+      }
     } else {
       name = opt->name;
     }
-- 
2.17.0

