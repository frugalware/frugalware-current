From c34dd9bb1ad269daac205143be3516e0e01a74bb Mon Sep 17 00:00:00 2001
From: Mathieu Duponchelle <mathieu@centricular.com>
Date: Thu, 12 Jul 2018 22:05:27 +0200
Subject: [PATCH 46/72] avcfg: ignore some generic properties

We expose profile, level and colorimetry / colorspaces through
caps.

https://bugzilla.gnome.org/show_bug.cgi?id=792900
---
 ext/libav/gstavcfg.c | 15 +++++++++++++++
 1 file changed, 15 insertions(+)

diff --git a/ext/libav/gstavcfg.c b/ext/libav/gstavcfg.c
index 3f98da2..5152024 100644
--- a/ext/libav/gstavcfg.c
+++ b/ext/libav/gstavcfg.c
@@ -52,6 +52,21 @@ make_generic_overrides (void)
       gst_structure_new_empty ("bitrate-tolerance"));
   g_hash_table_insert (generic_overrides, g_strdup ("bf"),
       gst_structure_new_empty ("max-bframes"));
+
+  /* Those are exposed through caps */
+  g_hash_table_insert (generic_overrides, g_strdup ("profile"),
+      gst_structure_new ("profile", "skip", G_TYPE_BOOLEAN, TRUE, NULL));
+  g_hash_table_insert (generic_overrides, g_strdup ("level"),
+      gst_structure_new ("level", "skip", G_TYPE_BOOLEAN, TRUE, NULL));
+  g_hash_table_insert (generic_overrides, g_strdup ("color_primaries"),
+      gst_structure_new ("color_primaries", "skip", G_TYPE_BOOLEAN, TRUE,
+          NULL));
+  g_hash_table_insert (generic_overrides, g_strdup ("color_trc"),
+      gst_structure_new ("color_trc", "skip", G_TYPE_BOOLEAN, TRUE, NULL));
+  g_hash_table_insert (generic_overrides, g_strdup ("colorspace"),
+      gst_structure_new ("colorspace", "skip", G_TYPE_BOOLEAN, TRUE, NULL));
+  g_hash_table_insert (generic_overrides, g_strdup ("color_range"),
+      gst_structure_new ("color_range", "skip", G_TYPE_BOOLEAN, TRUE, NULL));
 }
 
 void
-- 
2.17.0

