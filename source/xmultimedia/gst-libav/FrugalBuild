# Compiling time: 1.94 SBU
# Maintainer: Baste <baste@frugalware.org>

pkgname=gst-libav
pkgver=1.14.4
pkgrel=2
pkgdesc="GStreamer plugin for the libav* library (former FFmpeg)"
url="http://gstreamer.freedesktop.org"
depends=('gst1-plugins-base>=1.14.3' 'libffi>=3.2.1-2' 'ffmpeg>=4.1')
makedepends=('yasm>=1.3.0-3')
groups=('xmultimedia')
archs=("x86_64")
_F_archive_grepv="1.15.*"
up2date="Flasttar $url/src/$pkgname/"
source=($url/src/$pkgname/$pkgname-$pkgver.tar.xz \
	0008-Expose-support-for-DSD.patch \
	0010-avmux-Remove-unneeded-constant-variable.patch \
	0011-libav-Switch-to-common-include.patch \
	0013-Don-t-include-deprecated-avfiltergraph.h-header.patch \
	0014-Use-AV_-namespace-for-INPUT_BUFFER_PADDING_SIZE.patch \
	0015-Use-AV_-namespace-for-all-CODEC_-macro.patch \
	0016-avviddec-Stop-using-deperated-EDGE-API.patch \
	0017-Refactor-avcfg-avvidenc.patch \
	0018-avaudenc-remove-obsolete-setting-of-rc_strategy.patch \
	0019-Remove-all-uses-of-AVPicture.patch \
	0020-avmux-port-to-AVCodecParameters.patch \
	0021-avdemux-port-to-AVCodecParameters.patch \
	0022-av_codec_next-deprecated-av_codec_iterate.patch \
	0023-avauddec-remove-obsolete-version-check.patch \
	0024-av_iformat_next-deprecated-av_demuxer_iterate.patch \
	0025-av_oformat_next-deprecated-av_muxer_iterate.patch \
	0026-auddec-stop-using-deprecated-getters.patch \
	0027-gstav-stop-calling-deprecated-registration-methods.patch \
	0028-avvidec-port-to-new-decoding-API.patch \
	0029-avviddec-fix-signed-unsigned-comparisons.patch \
	0030-avaudenc-install-options-generically.patch \
	0031-avaudenc-further-cleanup.patch \
	0032-avauddec-port-to-new-decoding-API.patch \
	0033-avauddec-fix-remaining-warnings.patch \
	0034-avmux-fix-remaining-warnings.patch \
	0035-avaudenc-port-to-send_frame-receive_packet.patch \
	0036-avviddec-fix-invalid-alignment-calculations.patch \
	0037-avvidenc-port-to-send_frame-receive_packet.patch \
	0040-configure-update-libav-configure-args.patch \
	0042-Update-ffmpeg-version-requirements.patch \
	0043-auddec-fix-luck-based-sinkpad-access.patch \
	0045-avcfg-add-skip-support-to-overrides-system.patch \
	0046-avcfg-ignore-some-generic-properties.patch \
	0047-avcfg-use-g_object_get_property-not-g_object_getv.patch \
	0048-av-dec-Ignore-decoding-errors.patch \
	0049-avcfg-actually-remove-call-to-g_object_getv.patch \
	0050-avcfg-Properly-initalize-GValue.patch \
	0052-Remove-swscale-plugin-code.patch \
	0053-Remove-obsolete-if-0-ed-code.patch \
	0056-avmux-Place-pva-case-after-generic-case.patch \
	0057-decoders-fix-draining.patch \
	0059-avcfg-Simplify-code.patch \
	0060-avviddec-Remove-unneeded-check.patch \
	0064-avdemux-Expose-IFF-container-support.patch \
	0065-avcfg-Ensure-that-ternary-operator-always-evaluates-.patch \
	0070-codecmap-Add-mapping-for-Voxware-metasound.patch )
sha1sums=('93c92745081265ae5769ad804bf1f89c541646c9' \
          '9ce316b859686c272d4566da61ad663f93213871' \
          '60de4c60cfe2f829fb8e2dc898834b5f0b7939d7' \
          'c4732a23fd86de58395b09eb3edee86751546950' \
          'f45e0d85dee2680e29dc203d7f79c3ee7428dd36' \
          '367be0c2fd13fa8214503a157248ee19c79bc083' \
          '13eea592e02702be129c634a1dedd7d89f03966a' \
          'a0095d2a420ad12d12440f959c29b7d7f4ea5361' \
          'f823fa101e2a8074fc275ee4e9471e14f0c2a0a5' \
          'bc88c5e8088de2e2b4880a931e3e5c250883da8d' \
          '7490b5c0a6d1f225ca41c80998d9e756e190e7f2' \
          '12bb9c1f2b834aa910a2aaf3eb49968d33e04a9a' \
          'e8f02373af6091398fbb66728db159598d68db9c' \
          'b08bfb5970bed86ecb90f1a5f43ee7303e41b7ef' \
          '50abed8e0ca2adbe33aebce2399ed7159fd60fca' \
          '2a91190716141aa8da5ee743d4c0f0e7c8cc07a9' \
          '88d0c2c14ce261924f25316fe6f4b4bc556bef01' \
          '3b7e16f92808b4a21930474ba2a73d84d6dfc6cc' \
          '650f0426275cb9a7633b5120b30c721c0f495773' \
          '954866608d1e65f5400cad55551c86685899e62f' \
          '9c324c8a7a088eeda708ad6ca554141151fdfed2' \
          'cf0fa5435797aac089abb982dc057578dff404e2' \
          '78927c75ba752ac3a5b3234168846ed54af393f3' \
          '2a94accc21b99147964c6c6db709ebd0f94aecb6' \
          'f0ee7c27ae4a614bf369286043bdaec7cf30b378' \
          '9ee6d8ef6c054158ec379d3ffe6b17ecf37093bc' \
          'a048dbfcf3961c28e9cc678886d50777d2e6d0f8' \
          'bdeff0293e32dafaadf471cff6c5f84887d800a6' \
          '426419d859623774c8145b83cc87627adc1e9fbe' \
          '5a9a01c0264080e7dbba667efad7a115666af670' \
          'a3b3dd32c1fb773cf7aa6ef91874808f35c8a1e7' \
          '6c8933bb16b8deabfc9ab59a96d6149c2492500e' \
          '9d7371333a0f1f9fef8c4588f8701595bbeabca4' \
          '3bf8dddc5d79569c807cc6279aa3ef7b040be58d' \
          'd2778846db923f3d0ec7bfd8e897a3edf26f2c9a' \
          'e48d81070c77cb6019eb074df6ef6e0842bad9cf' \
          'cb9fc02e6c7bef66447c688a4cbf41aa3ce381fa' \
          'cbdec9c11b4c8b27771d35f5f9d3b77db61c89d3' \
          '2f915435f2d4cf23e78a133f6e45ca39643692d0' \
          'd33f31836e68e3eaf7bc7514a2ce8a7b1ecb1742' \
          'a419b5a613ae9f089ebfb1a7c1b4415cf9ecf11b' \
          '62bab4ccc27a429038b2bd7a5c9bc8569408f359' \
          '362cd4bedfa46c82b31680bf469da34a8242e049' \
          'baf21dfe2b3da88212ea86116fcd8d8c01cb42ec' \
          '5b2435bd0288d62bcde69125c7abe803b4245e31' \
          'd53c6649bd73d861fcb5b6de3ba65cfbd2347332' \
          '94550ada775e2ce497aa17596ce834319222528c')

replaces=('gst-ffmpeg' 'gst1-plugins-ugly-mad')
provides=('gst-ffmpeg' 'gst1-plugins-ugly-mad')

build() {

	Fcd
	Fsed '-Werror' '' configure

	Fbuild \
		--disable-static \
		--with-system-libav \
		--enable-gpl \
		--with-package-name='Frugalware gstreamer libav plugin package' \
		--with-package-origin='http://frugalware.org/'
}

# optimization OK
